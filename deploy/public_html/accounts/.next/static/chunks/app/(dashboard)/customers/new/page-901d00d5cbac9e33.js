(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7833],{23878:(e,s,a)=>{"use strict";a.d(s,{NewCustomerClient:()=>E});var l=a(95155),t=a(12115),r=a(26497),i=a(34544),n=a(42529),c=a(6132),d=a(35299),o=a(96583),x=a(52987),m=a(19408),h=a(20508),u=a(89715),p=a(53409),b=a(37107),g=a(69141),j=a(23664),y=a(21873),v=a(39068),f=a(71871),N=a(58008),w=a(11696),_=a(75882),z=a(80647),A=a(52952),C=a(46046),k=a(52619),S=a.n(k),X=a(20063),q=a(36117);function E(e){let{accounts:s,costCenters:a,companyId:k}=e,E=(0,X.useRouter)(),[T,F]=(0,t.useState)(!1),[D,H]=(0,t.useState)({show:!1,type:"success",title:"",message:""}),[J,K]=(0,t.useState)({customer_name:"",company_name:"",commercial_number:"",vat_number:"",unified_number:"",email:"",phone:"",country:"",city:"",district:"",street_name:"",postal_code:"",short_address:"",account_id:"",cost_center_id:"",is_active:!0}),[M]=(0,t.useState)((0,q.oj)()),[R,B]=(0,t.useState)([]),[G,I]=(0,t.useState)([]);(0,t.useEffect)(()=>{J.country&&(B((0,q.TF)(J.country)),I([]))},[J.country]),(0,t.useEffect)(()=>{J.country&&J.city&&I((0,q.K0)(J.country,J.city))},[J.country,J.city]);let L=(e,s,a)=>{H({show:!0,type:e,title:s,message:a})},Q=()=>{H(e=>({...e,show:!1}))},U=e=>{let{name:s,value:a,type:l}=e.target;"country"===s?K(e=>({...e,country:a,city:"",district:""})):"city"===s?K(e=>({...e,city:a,district:""})):"checkbox"===l?K(a=>({...a,[s]:e.target.checked})):K(e=>({...e,[s]:a}))},V=async e=>{if(e.preventDefault(),!J.company_name||!J.commercial_number||!J.vat_number)return void L("error","خطأ في البيانات","يرجى ملء جميع الحقول الإجبارية (اسم المنشأة، السجل التجاري، الرقم الضريبي)");F(!0),L("loading","جاري الحفظ","جاري حفظ بيانات العميل...");try{let e=await fetch("/api/customers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...J,company_id:k,account_id:J.account_id||null,cost_center_id:J.cost_center_id||null})});if(e.ok)L("success","تم الحفظ بنجاح","تم إضافة العميل بنجاح"),setTimeout(()=>{E.push("/customers"),E.refresh()},1500);else{let s=await e.json();L("error","فشل الحفظ",s.error||"فشل حفظ العميل")}}catch(e){L("error","خطأ","حدث خطأ أثناء الحفظ")}finally{F(!1)}};return(0,l.jsxs)("div",{className:"h-full flex flex-col",children:[(0,l.jsx)(r.N,{children:D.show&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50",onClick:()=>"loading"!==D.type&&Q()}),(0,l.jsx)(i.P.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-50 w-full max-w-md",children:(0,l.jsx)("div",{className:"bg-white rounded-3xl p-8 shadow-2xl border-t-4 ".concat("success"===D.type?"border-emerald-500":"error"===D.type?"border-red-500":"border-blue-500"),children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsxs)("div",{className:"h-20 w-20 rounded-full mx-auto mb-6 flex items-center justify-center ".concat("success"===D.type?"bg-emerald-100 text-emerald-500":"error"===D.type?"bg-red-100 text-red-500":"bg-blue-100 text-blue-500"),children:["success"===D.type&&(0,l.jsx)(n.A,{size:40}),"error"===D.type&&(0,l.jsx)(c.A,{size:40}),"loading"===D.type&&(0,l.jsx)(d.A,{size:40,className:"animate-spin"})]}),(0,l.jsx)("h3",{className:"text-2xl font-black text-gray-900 mb-2",children:D.title}),(0,l.jsx)("p",{className:"text-gray-500 mb-6",children:D.message}),"loading"!==D.type&&(0,l.jsx)("button",{onClick:Q,className:"px-8 py-3 rounded-xl font-bold text-white transition-all ".concat("success"===D.type?"bg-emerald-500 hover:bg-emerald-600":"bg-red-500 hover:bg-red-600"),children:"حسناً"})]})})})]})}),(0,l.jsx)("div",{className:"flex-1 overflow-auto p-6",children:(0,l.jsxs)("div",{className:"max-w-[1200px] mx-auto space-y-6",children:[(0,l.jsxs)("div",{className:"relative overflow-hidden bg-gradient-to-br from-[#2c3e50] to-[#34495e] rounded-2xl p-6 text-white shadow-xl",children:[(0,l.jsx)("div",{className:"relative z-10",children:(0,l.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("div",{className:"h-14 w-14 rounded-xl bg-emerald-500 flex items-center justify-center shadow-lg",children:(0,l.jsx)(o.A,{size:28})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-black",children:"إضافة عميل جديد"}),(0,l.jsx)("p",{className:"text-white/60 text-sm",children:"تسجيل بيانات عميل أو منشأة جديدة"})]})]}),(0,l.jsx)(S(),{href:"/customers",children:(0,l.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2.5 rounded-xl bg-white/10 text-white font-bold text-sm hover:bg-white/20 transition-all border border-white/10",children:[(0,l.jsx)(x.A,{size:16}),(0,l.jsx)("span",{children:"العودة للقائمة"})]})})]})}),(0,l.jsx)("div",{className:"absolute top-0 right-0 w-40 h-40 bg-white/5 rounded-full -mr-20 -mt-20 blur-2xl"})]}),(0,l.jsxs)("form",{onSubmit:V,className:"space-y-6",children:[(0,l.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden",children:[(0,l.jsxs)("div",{className:"bg-blue-500 px-4 py-3 flex items-center gap-2 text-white",children:[(0,l.jsx)(m.A,{size:18}),(0,l.jsx)("h3",{className:"font-bold text-sm",children:"المعلومات الأساسية"})]}),(0,l.jsxs)("div",{className:"p-5 grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsx)(O,{icon:(0,l.jsx)(h.A,{size:16}),label:"اسم العميل",name:"customer_name",value:J.customer_name,onChange:U,placeholder:"أدخل اسم العميل"}),(0,l.jsx)(O,{icon:(0,l.jsx)(m.A,{size:16}),label:"اسم المنشأة",name:"company_name",value:J.company_name,onChange:U,placeholder:"أدخل اسم المنشأة",required:!0}),(0,l.jsx)(O,{icon:(0,l.jsx)(u.A,{size:16}),label:"السجل التجاري",name:"commercial_number",value:J.commercial_number,onChange:U,placeholder:"أدخل رقم السجل التجاري",required:!0}),(0,l.jsx)(O,{icon:(0,l.jsx)(p.A,{size:16}),label:"الرقم الضريبي",name:"vat_number",value:J.vat_number,onChange:U,placeholder:"أدخل الرقم الضريبي",required:!0}),(0,l.jsx)(O,{icon:(0,l.jsx)(b.A,{size:16}),label:"الرقم الموحد",name:"unified_number",value:J.unified_number,onChange:U,placeholder:"أدخل الرقم الموحد (اختياري)"})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden",children:[(0,l.jsxs)("div",{className:"bg-emerald-500 px-4 py-3 flex items-center gap-2 text-white",children:[(0,l.jsx)(g.A,{size:18}),(0,l.jsx)("h3",{className:"font-bold text-sm",children:"معلومات الاتصال"})]}),(0,l.jsxs)("div",{className:"p-5 grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsx)(O,{icon:(0,l.jsx)(j.A,{size:16}),label:"البريد الإلكتروني",name:"email",type:"email",value:J.email,onChange:U,placeholder:"example@domain.com"}),(0,l.jsx)(O,{icon:(0,l.jsx)(g.A,{size:16}),label:"رقم الهاتف",name:"phone",value:J.phone,onChange:U,placeholder:"+966 5X XXX XXXX"})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden",children:[(0,l.jsxs)("div",{className:"bg-purple-500 px-4 py-3 flex items-center gap-2 text-white",children:[(0,l.jsx)(y.A,{size:18}),(0,l.jsx)("h3",{className:"font-bold text-sm",children:"العنوان"})]}),(0,l.jsxs)("div",{className:"p-5 grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsx)(P,{icon:(0,l.jsx)(v.A,{size:16}),label:"الدولة",name:"country",value:J.country,onChange:U,options:M.map(e=>({value:e,label:e})),placeholder:"اختر الدولة"}),(0,l.jsx)(P,{icon:(0,l.jsx)(f.A,{size:16}),label:"المدينة",name:"city",value:J.city,onChange:U,options:R.map(e=>({value:e,label:e})),placeholder:"اختر المدينة",disabled:!J.country}),(0,l.jsx)(P,{icon:(0,l.jsx)(N.A,{size:16}),label:"الحي",name:"district",value:J.district,onChange:U,options:G.map(e=>({value:e,label:e})),placeholder:"اختر الحي",disabled:!J.city}),(0,l.jsx)(O,{icon:(0,l.jsx)(w.A,{size:16}),label:"اسم الشارع",name:"street_name",value:J.street_name,onChange:U,placeholder:"أدخل اسم الشارع"}),(0,l.jsx)(O,{icon:(0,l.jsx)(b.A,{size:16}),label:"الرمز البريدي",name:"postal_code",value:J.postal_code,onChange:U,placeholder:"أدخل الرمز البريدي"}),(0,l.jsx)(O,{icon:(0,l.jsx)(y.A,{size:16}),label:"العنوان المختصر",name:"short_address",value:J.short_address,onChange:U,placeholder:"أدخل العنوان المختصر"})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden",children:[(0,l.jsxs)("div",{className:"bg-orange-500 px-4 py-3 flex items-center gap-2 text-white",children:[(0,l.jsx)(_.A,{size:18}),(0,l.jsx)("h3",{className:"font-bold text-sm",children:"المعلومات المالية"})]}),(0,l.jsxs)("div",{className:"p-5 grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsx)(P,{icon:(0,l.jsx)(_.A,{size:16}),label:"مركز الحساب",name:"account_id",value:J.account_id,onChange:U,options:s.map(e=>({value:String(e.id),label:"".concat(e.account_code," - ").concat(e.account_name)})),placeholder:"اختر مركز الحساب"}),(0,l.jsx)(P,{icon:(0,l.jsx)(z.A,{size:16}),label:"مركز التكلفة",name:"cost_center_id",value:J.cost_center_id,onChange:U,options:a.map(e=>({value:String(e.id),label:"".concat(e.center_code," - ").concat(e.center_name)})),placeholder:"اختر مركز التكلفة"})]})]}),(0,l.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden",children:[(0,l.jsxs)("div",{className:"bg-gray-600 px-4 py-3 flex items-center gap-2 text-white",children:[(0,l.jsx)(A.A,{size:18}),(0,l.jsx)("h3",{className:"font-bold text-sm",children:"إعدادات الحساب"})]}),(0,l.jsx)("div",{className:"p-5",children:(0,l.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("input",{type:"checkbox",name:"is_active",checked:J.is_active,onChange:U,className:"sr-only peer"}),(0,l.jsx)("div",{className:"w-12 h-6 bg-gray-200 rounded-full peer peer-checked:bg-emerald-500 transition-colors"}),(0,l.jsx)("div",{className:"absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow peer-checked:translate-x-6 transition-transform"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(A.A,{size:16,className:"text-gray-500"}),(0,l.jsx)("span",{className:"font-bold text-gray-700 text-sm",children:"الحساب نشط"})]})]})})]}),(0,l.jsxs)("div",{className:"flex justify-center gap-4 pt-2 pb-6",children:[(0,l.jsx)(S(),{href:"/customers",children:(0,l.jsxs)("button",{type:"button",className:"flex items-center gap-2 px-6 py-3 rounded-xl bg-gray-100 text-gray-700 font-bold text-sm hover:bg-gray-200 transition-all",children:[(0,l.jsx)(x.A,{size:16}),(0,l.jsx)("span",{children:"إلغاء"})]})}),(0,l.jsxs)("button",{type:"submit",disabled:T,className:"flex items-center gap-2 px-6 py-3 rounded-xl bg-emerald-500 text-white font-bold text-sm hover:bg-emerald-600 transition-all disabled:opacity-50",children:[T?(0,l.jsx)(d.A,{size:16,className:"animate-spin"}):(0,l.jsx)(C.A,{size:16}),(0,l.jsx)("span",{children:T?"جاري الحفظ...":"حفظ العميل"})]})]})]})]})})]})}function O(e){let{icon:s,label:a,name:t,value:r,onChange:i,placeholder:n,required:c,type:d="text"}=e;return(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"flex items-center gap-1.5 text-xs font-bold text-gray-700 mb-1.5",children:[(0,l.jsx)("span",{className:"text-gray-400",children:s}),a,c&&(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("input",{type:d,name:t,value:r,onChange:i,placeholder:n,required:c,className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:border-blue-500 focus:ring-1 focus:ring-blue-500/20 outline-none transition-all text-sm"})]})}function P(e){let{icon:s,label:a,name:t,value:r,onChange:i,options:n,placeholder:c,disabled:d,required:o}=e;return(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"flex items-center gap-1.5 text-xs font-bold text-gray-700 mb-1.5",children:[(0,l.jsx)("span",{className:"text-gray-400",children:s}),a,o&&(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsxs)("select",{name:t,value:r,onChange:i,disabled:d,required:o,className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:border-blue-500 focus:ring-1 focus:ring-blue-500/20 outline-none transition-all text-sm disabled:bg-gray-50 disabled:text-gray-400",children:[(0,l.jsx)("option",{value:"",children:c}),n.map(e=>(0,l.jsx)("option",{value:e.value,children:e.label},e.value))]})]})}},36246:(e,s,a)=>{Promise.resolve().then(a.bind(a,23878))},96583:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});let l=(0,a(71847).A)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])}},e=>{e.O(0,[2418,2619,6748,7267,8441,1255,7358],()=>e(e.s=36246)),_N_E=e.O()}]);