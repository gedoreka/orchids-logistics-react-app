(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6460],{15879:(e,t,s)=>{"use strict";s.d(t,{CommissionsClient:()=>V});var a=s(95155),r=s(12115),l=s(26497),i=s(34544),n=s(50906),c=s(91169),o=s(15870),d=s(71360),x=s(46046),m=s(42529),p=s(23664),u=s(309),h=s(91761),b=s(89715),g=s(6132),y=s(35299),f=s(65229),j=s(18085),N=s(66955),v=s(16485),w=s(29633),k=s(6191),_=s(19204),z=s(86651),A=s(57828),C=s(26983),S=s(12181),P=s(24573),F=s(61194),L=s(59e3),T=s(89559),E=s(1524),M=s(39867),D=s(83884),G=s(64269),O=s(86550),R=s(20063),q=s(52619),J=s.n(q),W=s(94222),H=s(51834),U=s(20908),Y=s(95740),I=s(27937);function Q(e){let{title:t,instructions:s,triggerText:r="عرض تعليمات الصفحة",className:l}=e;return(0,a.jsxs)(H.lG,{children:[(0,a.jsx)(H.zM,{asChild:!0,children:(0,a.jsxs)("button",{className:(0,G.cn)("flex items-center gap-2 px-4 py-2 rounded-xl bg-white/10 hover:bg-white/20 text-white border border-white/20 transition-all duration-300 group shadow-lg backdrop-blur-md",l),children:[(0,a.jsx)("div",{className:"h-8 w-8 rounded-lg bg-blue-500/20 flex items-center justify-center group-hover:bg-blue-500/40 transition-colors",children:(0,a.jsx)(U.A,{size:18,className:"text-blue-400 group-hover:text-blue-300"})}),(0,a.jsx)("span",{className:"text-sm font-black tracking-tight",children:r})]})}),(0,a.jsxs)(H.Cf,{className:"max-w-2xl bg-[#f8fafc] p-0 border-none rounded-[2.5rem] overflow-hidden shadow-2xl",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-[#1e293b] to-[#334155] p-8 text-white relative",children:[(0,a.jsx)(H.c7,{children:(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-2",children:[(0,a.jsx)("div",{className:"h-12 w-12 rounded-2xl bg-white/10 flex items-center justify-center border border-white/10 shadow-inner",children:(0,a.jsx)(Y.A,{size:24,className:"text-amber-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(H.L3,{className:"text-2xl font-black text-white",children:t}),(0,a.jsx)("p",{className:"text-blue-200/60 text-xs font-bold uppercase tracking-widest mt-1",children:"دليل الاستخدام والمميزات"})]})]})}),(0,a.jsx)("div",{className:"absolute -top-12 -right-12 w-48 h-48 bg-blue-500/10 rounded-full blur-3xl"})]}),(0,a.jsx)("div",{className:"p-8 max-h-[70vh] overflow-y-auto custom-scrollbar",children:(0,a.jsx)("div",{className:"grid grid-cols-1 gap-4",children:s.map((e,t)=>(0,a.jsxs)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"group p-6 rounded-[2rem] bg-white border border-gray-100 shadow-sm hover:shadow-xl hover:border-blue-100 hover:-translate-y-1 transition-all duration-300 flex items-start gap-5",children:[(0,a.jsx)("div",{className:"h-14 w-14 rounded-2xl bg-blue-50 text-blue-500 flex items-center justify-center shrink-0 group-hover:bg-blue-500 group-hover:text-white transition-all duration-500 shadow-inner",children:e.icon}),(0,a.jsxs)("div",{className:"space-y-1.5",children:[(0,a.jsxs)("h4",{className:"font-black text-gray-900 flex items-center gap-2",children:[e.title,(0,a.jsx)(I.A,{size:14,className:"text-gray-300 group-hover:text-blue-500 group-hover:translate-x-1 transition-all"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-500 font-medium leading-relaxed",children:e.description})]})]},t))})}),(0,a.jsx)("div",{className:"p-6 bg-white border-t border-gray-50 flex justify-center",children:(0,a.jsx)("p",{className:"text-[10px] font-black text-gray-300 uppercase tracking-[0.2em]",children:"Logistics Systems Pro • الذكاء في إدارة اللوجستيات"})})]})]})}function V(e){var t,s,q,H,U,Y,I,V;let{companyId:$,initialPackages:B}=e;(0,R.useRouter)();let K=(0,D.c)("hr.commissions");(0,D.c)("common");let{locale:X}=(0,D.Y)(),ee="ar"===X,et=[{icon:(0,a.jsx)(n.A,{size:24}),title:"نظرة عامة على النظام",description:"يتيح لك النظام تتبع دقيق لعمليات الصرف والعمولات الشهرية الخاصة بمؤسستك، مما يضمن الشفافية والكفاءة في إدارة المستحقات."},{icon:(0,a.jsx)(c.A,{size:24}),title:"إعداد الموظفين",description:"ابدأ أولاً بإضافة الموظفين من صفحة 'إدارة الموارد البشرية'، مع اختيار نوع الباقة (عمولة) وتعبئة البيانات ليتم إدراجهم تلقائياً هنا."},{icon:(0,a.jsx)(o.A,{size:24}),title:"تخصيص العمولات",description:"حدد نوع العمولة (مبلغ ثابت يومي/شهري أو نسبة مئوية) لكل موظف بكل مرونة حسب سياسة الشركة."},{icon:(0,a.jsx)(d.A,{size:24}),title:"التحكم بالجدول",description:"واجهة تفاعلية تسمح لك بحذف الموظفين أو تعديل بياناتهم، مع إمكانية تحديد الكل أو استبعاد غير المختارين قبل الحفظ."},{icon:(0,a.jsx)(x.A,{size:24}),title:"الأرشفة والحفظ",description:"عند حفظ البيانات، يتم تخزينها في 'المجموعات المحفوظة' للرجوع إليها لاحقاً ومتابعة حالة السداد بشكل مستقل."},{icon:(0,a.jsx)(m.A,{size:24}),title:"تحديث حالة السداد",description:"بعد حفظ التقرير، يمكنك تحديث حالة الدفع (مدفوع/معلق) بضغطة زر واحدة لتنظيم التدفقات النقدية."},{icon:(0,a.jsx)(p.A,{size:24}),title:"نظام المراسلات الذكي",description:"يرسل النظام تلقائياً إيصال سداد عند الدفع، أو إشعار مطالبة احترافي ولبق في حال كانت الحالة 'معلق'."},{icon:(0,a.jsx)(u.A,{size:24}),title:"أدوات إدارية متقدمة",description:"استفد من ميزات الطباعة الاحترافية وتصدير البيانات والمتابعة الدقيقة لكل تفاصيل قسم العمولات."}],[es,ea]=(0,r.useState)("manage"),[er,el]=(0,r.useState)(!1),[ei,en]=(0,r.useState)(!1),[ec,eo]=(0,r.useState)(null),[ed,ex]=(0,r.useState)({show:!1,commission:null,email:""}),[em,ep]=(0,r.useState)((0,O.GP)(new Date,"yyyy-MM")),[eu,eh]=(0,r.useState)(""),[eb,eg]=(0,r.useState)("fixed_daily"),[ey,ef]=(0,r.useState)(""),[ej,eN]=(0,r.useState)(B),[ev,ew]=(0,r.useState)([]),[ek,e_]=(0,r.useState)([]),[ez,eA]=(0,r.useState)([]),[eC,eS]=(0,r.useState)(null),eP=(0,r.useRef)(null),eF=(0,W.useReactToPrint)({contentRef:eP,documentTitle:"تقرير العمولات - ".concat(em)}),eL=(e,t,s,a)=>{eS({show:!0,type:e,message:t,detail:s,onConfirm:a}),"loading"!==e&&"confirm"!==e&&setTimeout(()=>eS(null),4e3)};(0,r.useEffect)(()=>{eT()},[em]);let eT=async()=>{try{let e=await fetch("/api/hr/commissions?company_id=".concat($,"&month=").concat(em)),t=await e.json();ew(t.savedGroups||[])}catch(e){console.error("Error fetching saved groups:",e)}},eE=async(e,t)=>{eh(e),eg(t),await eM(e,t,!0),ea("report")},eM=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:eu,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eb,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e){el(!0);try{let a=await fetch("/api/hr/commissions?company_id=".concat($,"&month=").concat(em,"&package_id=").concat(e,"&mode=").concat(t)),r=await a.json(),l=r.employees||[],i=r.loadedCommissions||[],n=new Map;i.forEach(e=>n.set(e.employee_id,e));let c=[];c=s?i.map(e=>{let t=l.find(t=>t.id===e.employee_id)||{};return{id:e.id,employee_id:e.employee_id,name:t.name||"موظف محذوف",iqama_number:t.iqama_number||"",nationality:t.nationality||"",phone:t.phone||"",user_code:t.user_code||"",email:t.email||"",start_date:e.start_date?(0,O.GP)(new Date(e.start_date),"yyyy-MM-dd"):"",daily_amount:Number(e.daily_amount)||0,days:Number(e.days)||0,total:Number(e.total)||0,percentage:Number(e.percentage)||0,revenue:Number(e.revenue)||0,commission:Number(e.commission)||0,remaining:Number(e.remaining)||0,deduction:Number(e.deduction)||0,bonus:Number(e.bonus)||0,status:e.status||"unpaid",selected:!0}}):l.map(e=>{let t=n.get(e.id)||{};return{id:t.id,employee_id:e.id,name:e.name,iqama_number:e.iqama_number,nationality:e.nationality,phone:e.phone,user_code:e.user_code,email:e.email||"",start_date:t.start_date?(0,O.GP)(new Date(t.start_date),"yyyy-MM-dd"):"",daily_amount:Number(t.daily_amount)||0,days:Number(t.days)||0,total:Number(t.total)||0,percentage:Number(t.percentage)||0,revenue:Number(t.revenue)||0,commission:Number(t.commission)||0,remaining:Number(t.remaining)||0,deduction:Number(t.deduction)||0,bonus:Number(t.bonus)||0,status:t.status||"unpaid",selected:!!t.id}}),e_(l),eA(c)}catch(e){eL("error",K("notifications.error"))}finally{el(!1)}}},eD=async(e,t,s)=>{let a=[...ez];if(a[e][t]=s,"selected"!==t&&"status"!==t){if("fixed_daily"===eb)("daily_amount"===t||"days"===t)&&(a[e].total=(parseFloat(a[e].daily_amount)||0)*(parseFloat(a[e].days)||0));else if("fixed_monthly"===eb)"daily_amount"===t&&(a[e].total=parseFloat(a[e].daily_amount)||0,a[e].days=1);else if("percentage"===t||"revenue"===t){let t=parseFloat(a[e].revenue)||0,s=parseFloat(a[e].percentage)||0;a[e].commission=t*s/100,a[e].remaining=t-a[e].commission}}if("status"===t&&a[e].id)try{await fetch("/api/hr/commissions",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({employee_commission_id:a[e].id,status:s})}),eL("success","تم تحديث حالة ".concat(a[e].name," إلى ").concat("paid"===s?"تم الدفع":"لم يتم الدفع"))}catch(e){console.error("Update status error:",e)}eA(a)},eG=(0,r.useMemo)(()=>{if(!ey.trim())return ez;let e=ey.toLowerCase().trim();return ez.filter(t=>t.name.toLowerCase().includes(e)||t.iqama_number.includes(e)||t.user_code.includes(e))},[ez,ey]),eO=()=>{let e=eG.every(e=>e.selected);eA(t=>{let s=new Set(eG.map(e=>e.employee_id));return t.map(t=>s.has(t.employee_id)?{...t,selected:!e}:t)})},eR=ez.filter(e=>e.selected).length,eq=async()=>{if(!eu)return void eL("error",K("notifications.error"));let e=ez.filter(e=>e.selected);if(0===e.length)return void eL("error","يرجى تحديد موظف واحد على الأقل");en(!0),eL("loading","جاري حفظ البيانات...");try{let t=await fetch("/api/hr/commissions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({company_id:$,month:em,mode:eb,package_id:eu,commissions:e})});if(t.ok){let s=await t.json();eL("success","تم حفظ التقرير بنجاح رقم ".concat(s.serial_number),"تم حفظ عمولات لعدد ".concat(e.length," موظف بنجاح.")),eT(),eM(eu,eb,!0),ea("report")}else eL("error",K("notifications.error"))}catch(e){eL("error",K("notifications.error"))}finally{en(!1)}},eJ=async(e,t)=>{try{(await fetch("/api/hr/commissions?company_id=".concat($,"&month=").concat(em,"&package_id=").concat(e,"&mode=").concat(t),{method:"DELETE"})).ok&&(eL("success","تم حذف التقرير بنجاح","تمت إزالة جميع بيانات التقرير من النظام."),eT(),eu===e&&eb===t&&(e_([]),eA([]),eh("")))}catch(e){eL("error",K("notifications.error"))}},eW=async e=>{let t="paid"===e.status?"unpaid":"paid";try{(await fetch("/api/hr/commissions",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({company_id:$,month:em,package_id:e.package_id,mode:e.mode,status:t})})).ok&&(eL("success","تم تغيير الحالة إلى ".concat("paid"===t?"تم الدفع":"لم يتم الدفع"),"تم تحديث حالة جميع الموظفين في هذا التقرير."),eT(),eu===e.package_id&&eb===e.mode&&eA(e=>e.map(e=>({...e,status:t}))))}catch(e){eL("error",K("notifications.error"))}},eH=async()=>{let{commission:e,email:t}=ed;if(!t||!t.includes("@"))return void eL("error","يرجى إدخال بريد إلكتروني صحيح");eo(e.id),eL("loading","جاري إرسال البريد الإلكتروني...");try{let s=await fetch("/api/hr/commissions/send-receipt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({commission_id:e.id,email:t})}),a=await s.json();s.ok?(eL("success","تم إرسال سند السداد بنجاح","تم إرسال البريد الإلكتروني إلى ".concat(e.name," بنجاح.")),ex({...ed,show:!1})):eL("error",a.error||"فشل إرسال البريد")}catch(e){eL("error","حدث خطأ أثناء الإرسال")}finally{eo(null)}},eU=ez.reduce((e,t)=>e+(eb.startsWith("fixed")?Number(t.total)||0:Number(t.commission)||0)+(Number(t.bonus)||0)-(Number(t.deduction)||0),0),eY=ez.filter(e=>"paid"===e.status).length,eI=ez.length-eY,eQ=e=>{switch(e){case"fixed_daily":return"مبلغ ثابت (يومي)";case"fixed_monthly":return"مبلغ ثابت (شهري)";case"percentage":return"نسبة مئوية";default:return e}};return(0,a.jsxs)("div",{className:"min-h-screen bg-[#f8fafc] p-4 md:p-8",dir:ee?"rtl":"ltr",children:[(0,a.jsxs)("div",{className:"relative mb-8 rounded-[2rem] bg-gradient-to-r from-[#1e293b] to-[#334155] p-8 text-white shadow-2xl overflow-hidden",children:[(0,a.jsxs)("div",{className:"relative z-10 flex flex-col md:flex-row md:items-center justify-between gap-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsx)("div",{className:"h-16 w-16 rounded-2xl bg-white/10 backdrop-blur-md flex items-center justify-center border border-white/20 shadow-inner",children:(0,a.jsx)(h.A,{size:32,className:"text-blue-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-black tracking-tight",children:K("title")}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-1",children:[(0,a.jsx)("p",{className:"text-blue-200 font-medium opacity-80",children:K("subtitle")}),(0,a.jsx)("div",{className:"h-4 w-px bg-white/10"}),(0,a.jsx)(Q,{title:"نظام العمولات الشهرية",instructions:et,triggerText:"عرض تعليمات الصفحة"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 bg-white/5 backdrop-blur-sm p-1.5 rounded-2xl border border-white/10",children:[(0,a.jsx)("button",{onClick:()=>ea("manage"),className:(0,G.cn)("px-6 py-2.5 rounded-xl font-bold text-sm transition-all duration-300","manage"===es?"bg-blue-500 text-white shadow-lg":"text-white/60 hover:text-white hover:bg-white/5"),children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(o.A,{size:16}),(0,a.jsx)("span",{children:"إدارة العمولات"})]})}),(0,a.jsx)("button",{onClick:()=>ea("report"),className:(0,G.cn)("px-6 py-2.5 rounded-xl font-bold text-sm transition-all duration-300","report"===es?"bg-blue-500 text-white shadow-lg":"text-white/60 hover:text-white hover:bg-white/5"),children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(b.A,{size:16}),(0,a.jsx)("span",{children:"تقرير العمولات"})]})})]})]}),(0,a.jsx)("div",{className:"absolute -top-24 -right-24 w-64 h-64 bg-blue-500/10 rounded-full blur-3xl"}),(0,a.jsx)("div",{className:"absolute -bottom-24 -left-24 w-64 h-64 bg-purple-500/10 rounded-full blur-3xl"})]}),(0,a.jsx)(l.N,{children:eC&&(0,a.jsx)(i.P.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm",children:(0,a.jsxs)("div",{className:"bg-white rounded-[2.5rem] shadow-2xl border border-gray-100 max-w-md w-full p-8 text-center overflow-hidden relative",children:[(0,a.jsx)("div",{className:(0,G.cn)("absolute top-0 left-0 w-full h-2","success"===eC.type?"bg-emerald-500":"error"===eC.type?"bg-red-500":"confirm"===eC.type?"bg-amber-500":"bg-blue-500")}),(0,a.jsxs)("div",{className:(0,G.cn)("mx-auto h-20 w-20 rounded-3xl flex items-center justify-center mb-6 shadow-lg","success"===eC.type?"bg-emerald-50 text-emerald-500":"error"===eC.type?"bg-red-50 text-red-500":"confirm"===eC.type?"bg-amber-50 text-amber-500":"bg-blue-50 text-blue-500"),children:["success"===eC.type&&(0,a.jsx)(m.A,{size:40}),"error"===eC.type&&(0,a.jsx)(g.A,{size:40}),"confirm"===eC.type&&(0,a.jsx)(d.A,{size:40}),"loading"===eC.type&&(0,a.jsx)(y.A,{size:40,className:"animate-spin"})]}),(0,a.jsx)("h3",{className:"text-xl font-black text-gray-900 mb-2",children:eC.message}),eC.detail&&(0,a.jsx)("p",{className:"text-gray-500 text-sm font-medium mb-8 leading-relaxed",children:eC.detail}),(0,a.jsx)("div",{className:"flex items-center gap-3",children:"confirm"===eC.type?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>eS(null),className:"flex-1 py-4 rounded-2xl bg-gray-100 text-gray-700 font-black text-sm hover:bg-gray-200 transition-all",children:"إلغاء"}),(0,a.jsx)("button",{onClick:()=>{var e;null==(e=eC.onConfirm)||e.call(eC),eS(null)},className:"flex-1 py-4 rounded-2xl bg-red-500 text-white font-black text-sm hover:bg-red-600 shadow-xl shadow-red-100 transition-all",children:"تأكيد الحذف"})]}):"loading"!==eC.type&&(0,a.jsx)("button",{onClick:()=>eS(null),className:"w-full py-4 rounded-2xl bg-gray-900 text-white font-black text-sm hover:bg-gray-800 shadow-xl transition-all",children:"حسناً"})})]})})}),(0,a.jsx)(l.N,{children:ed.show&&(0,a.jsx)(i.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[110] flex items-center justify-center p-4 bg-black/60 backdrop-blur-md",children:(0,a.jsxs)(i.P.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-white rounded-[2.5rem] shadow-2xl w-full max-w-md p-8 relative overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute top-0 left-0 w-full h-2 bg-blue-500"}),(0,a.jsx)("div",{className:(0,G.cn)("absolute top-0 left-0 w-full h-2",(null==(t=ed.commission)?void 0:t.status)==="paid"?"bg-emerald-500":"bg-red-500")}),(0,a.jsx)("button",{onClick:()=>ex({...ed,show:!1}),className:"absolute top-6 right-6 p-2 rounded-xl hover:bg-gray-100 text-gray-400 transition-all",children:(0,a.jsx)(f.A,{size:20})}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-8",children:[(0,a.jsx)("div",{className:(0,G.cn)("h-14 w-14 rounded-2xl flex items-center justify-center shadow-sm border",(null==(s=ed.commission)?void 0:s.status)==="paid"?"bg-emerald-50 text-emerald-500 border-emerald-100":"bg-red-50 text-red-500 border-red-100"),children:(0,a.jsx)(p.A,{size:28})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-black text-gray-900",children:(null==(q=ed.commission)?void 0:q.status)==="paid"?"إرسال سند سداد":"إرسال مطالبة مالية"}),(0,a.jsx)("p",{className:"text-sm text-gray-400 font-medium",children:(null==(H=ed.commission)?void 0:H.status)==="paid"?"سيتم إرسال تأكيد بالصرف للموظف":"سيتم إرسال إشعار مطالبة مالية لتنبيه الموظف بسرعة السداد"})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:(0,G.cn)("p-4 rounded-2xl border mb-6",(null==(U=ed.commission)?void 0:U.status)==="paid"?"bg-emerald-50/30 border-emerald-100/50":"bg-red-50/30 border-red-100/50"),children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"h-10 w-10 rounded-full bg-white flex items-center justify-center text-gray-400 shadow-sm",children:(0,a.jsx)(c.A,{size:18})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-[10px] text-gray-400 font-black uppercase",children:"الموظف"}),(0,a.jsx)("p",{className:"font-black text-gray-900",children:null==(Y=ed.commission)?void 0:Y.name})]})]})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mr-2 block",children:"البريد الإلكتروني"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(p.A,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400",size:18}),(0,a.jsx)("input",{type:"email",value:ed.email,onChange:e=>ex({...ed,email:e.target.value}),placeholder:"employee@example.com",className:"w-full pl-4 pr-12 py-4 rounded-2xl border border-gray-100 bg-gray-50 focus:bg-white focus:border-blue-500 focus:ring-4 focus:ring-blue-500/5 outline-none font-bold transition-all text-sm",autoFocus:!0})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 pt-4",children:[(0,a.jsx)("button",{onClick:()=>ex({...ed,show:!1}),className:"flex-1 py-4 rounded-2xl bg-gray-100 text-gray-700 font-black text-sm hover:bg-gray-200 transition-all",children:"إلغاء"}),(0,a.jsxs)("button",{onClick:eH,className:(0,G.cn)("flex-2 px-8 py-4 rounded-2xl text-white font-black text-sm shadow-xl active:scale-95 transition-all flex items-center justify-center gap-2",(null==(I=ed.commission)?void 0:I.status)==="paid"?"bg-emerald-600 hover:bg-emerald-700 shadow-emerald-100":"bg-red-600 hover:bg-red-700 shadow-red-100"),children:[(0,a.jsx)(j.A,{size:18}),(0,a.jsx)("span",{children:(null==(V=ed.commission)?void 0:V.status)==="paid"?"إرسال السند":"إرسال المطالبة"})]})]})]})]})})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,a.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-3xl p-6 shadow-sm border border-gray-100",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-6 text-gray-900",children:[(0,a.jsx)(N.A,{size:20,className:"text-blue-500"}),(0,a.jsx)("h2",{className:"font-black text-lg",children:K("filters")})]}),(0,a.jsxs)("div",{className:"space-y-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-2 block",children:K("month")}),(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsx)(v.A,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 group-focus-within:text-blue-500 transition-colors",size:18}),(0,a.jsx)("input",{type:"month",value:em,onChange:e=>ep(e.target.value),className:"w-full pl-4 pr-10 py-3 rounded-2xl border border-gray-100 bg-gray-50 focus:bg-white focus:border-blue-500 focus:ring-4 focus:ring-blue-500/5 outline-none font-bold text-sm transition-all"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-2 block",children:K("package")}),(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsx)(w.A,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 group-focus-within:text-blue-500 transition-colors",size:18}),(0,a.jsxs)("select",{value:eu,onChange:e=>eh(e.target.value),className:"w-full pl-4 pr-10 py-3 rounded-2xl border border-gray-100 bg-gray-50 focus:bg-white focus:border-blue-500 focus:ring-4 focus:ring-blue-500/5 outline-none font-bold text-sm transition-all appearance-none",children:[(0,a.jsx)("option",{value:"",children:K("package")}),ej.map(e=>(0,a.jsx)("option",{value:e.id,children:e.group_name},e.id))]})]})]}),(0,a.jsx)("div",{className:"pt-2",children:(0,a.jsxs)(J(),{href:"/hr/packages?type=commission&create=true",className:"w-full py-3 rounded-2xl bg-purple-50 text-purple-600 font-black text-[10px] border border-purple-100 hover:bg-purple-100 transition-all flex items-center justify-center gap-2 group/btn",children:[(0,a.jsx)(k.A,{size:14,className:"group-hover/btn:rotate-90 transition-transform"}),(0,a.jsx)("span",{children:"إضافة باقة عمولة جديدة"})]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-2 block",children:K("commissionType")}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 p-2 bg-gray-50 rounded-2xl border border-gray-100",children:[(0,a.jsxs)("button",{onClick:()=>eg("fixed_daily"),className:(0,G.cn)("py-2.5 rounded-xl text-xs font-black transition-all flex items-center justify-center gap-2","fixed_daily"===eb?"bg-white text-blue-600 shadow-md border border-gray-100":"text-gray-400 hover:text-gray-600"),children:[(0,a.jsx)(n.A,{size:14}),(0,a.jsx)("span",{children:"مبلغ ثابت (يومي)"})]}),(0,a.jsxs)("button",{onClick:()=>eg("fixed_monthly"),className:(0,G.cn)("py-2.5 rounded-xl text-xs font-black transition-all flex items-center justify-center gap-2","fixed_monthly"===eb?"bg-white text-purple-600 shadow-md border border-gray-100":"text-gray-400 hover:text-gray-600"),children:[(0,a.jsx)(v.A,{size:14}),(0,a.jsx)("span",{children:"مبلغ ثابت (شهري)"})]}),(0,a.jsxs)("button",{onClick:()=>eg("percentage"),className:(0,G.cn)("py-2.5 rounded-xl text-xs font-black transition-all flex items-center justify-center gap-2","percentage"===eb?"bg-white text-amber-600 shadow-md border border-gray-100":"text-gray-400 hover:text-gray-600"),children:[(0,a.jsx)(_.A,{size:14}),(0,a.jsx)("span",{children:"نسبة مئوية"})]})]})]}),(0,a.jsxs)("button",{onClick:()=>eM(),disabled:er||!eu,className:"w-full py-4 rounded-2xl bg-blue-600 text-white font-black text-sm shadow-xl shadow-blue-200 hover:bg-blue-700 active:scale-[0.98] transition-all disabled:opacity-50 disabled:shadow-none flex items-center justify-center gap-2",children:[er?(0,a.jsx)(y.A,{size:20,className:"animate-spin"}):(0,a.jsx)(z.A,{size:20}),(0,a.jsx)("span",{children:K("viewData")})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-3xl p-6 shadow-sm border border-gray-100 overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-6 text-gray-900",children:[(0,a.jsx)(x.A,{size:20,className:"text-amber-500"}),(0,a.jsx)("h2",{className:"font-black text-lg",children:K("savedGroups")})]}),(0,a.jsx)("div",{className:"space-y-3",children:ev.length>0?ev.map((e,t)=>{let s=ej.find(t=>t.id===e.package_id);return(0,a.jsxs)(i.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*t},className:"p-4 rounded-2xl border border-gray-50 bg-gray-50/50 hover:bg-white hover:border-blue-100 hover:shadow-md transition-all group",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"h-5 w-5 rounded-md bg-gray-900 text-white flex items-center justify-center text-[10px] font-black",children:e.serial_number||t+1}),(0,a.jsx)("span",{className:"font-black text-sm text-gray-900 group-hover:text-blue-600 transition-colors",children:(null==s?void 0:s.group_name)||"باقة غير معروفة"})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("span",{className:(0,G.cn)("px-2 py-0.5 rounded text-[8px] font-black text-white",(e=>{switch(e){case"fixed_daily":return"bg-blue-500";case"fixed_monthly":return"bg-purple-500";case"percentage":return"bg-amber-500";default:return"bg-gray-500"}})(e.mode)),children:eQ(e.mode)})})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-2",children:[(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)("button",{onClick:()=>eE(e.package_id,e.mode),className:"p-1.5 rounded-lg bg-blue-100 text-blue-700 hover:bg-blue-600 hover:text-white transition-all shadow-sm",title:"عرض التقرير",children:(0,a.jsx)(A.A,{size:14})}),(0,a.jsx)("button",{onClick:()=>{var t,a,r;return t=e.package_id,a=e.mode,r=(null==s?void 0:s.group_name)||"",void eL("confirm","هل أنت متأكد من حذف التقرير؟","سيتم حذف تقرير ".concat(r," بشكل نهائي ولن يمكن استعادته."),()=>{eJ(t,a)})},className:"p-1.5 rounded-lg bg-red-100 text-red-700 hover:bg-red-600 hover:text-white transition-all shadow-sm",title:"حذف التقرير",children:(0,a.jsx)(d.A,{size:14})})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,a.jsx)("button",{onClick:()=>eW(e),className:(0,G.cn)("w-10 h-5 rounded-full relative transition-all duration-300 shadow-inner group/toggle","paid"===e.status?"bg-emerald-500":"bg-gray-300"),children:(0,a.jsx)("div",{className:(0,G.cn)("absolute top-0.5 w-4 h-4 bg-white rounded-full transition-all shadow-sm group-hover/toggle:scale-110","paid"===e.status?"right-0.5":"left-0.5")})}),(0,a.jsx)("span",{className:(0,G.cn)("text-[7px] font-black uppercase","paid"===e.status?"text-emerald-600":"text-gray-400"),children:"paid"===e.status?"مدفوع":"معلق"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-3 pt-2 border-t border-gray-100/50",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,a.jsx)("span",{className:"text-[9px] text-gray-400 font-bold uppercase",children:"إجمالي العمولات"}),(0,a.jsxs)("span",{className:"text-xs font-black text-gray-900",children:[Number(e.total_amount).toLocaleString()," ر.س"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1.5 text-[10px] text-gray-400 font-medium self-end",children:[(0,a.jsx)(C.A,{size:12}),(0,a.jsx)("span",{children:(0,O.GP)(new Date(e.created_at),"yyyy/MM/dd")})]})]})]},"".concat(e.package_id,"-").concat(e.mode,"-").concat(e.serial_number))}):(0,a.jsxs)("div",{className:"text-center py-10 opacity-40 grayscale flex flex-col items-center gap-3",children:[(0,a.jsx)("div",{className:"h-16 w-16 rounded-full bg-gray-100 flex items-center justify-center",children:(0,a.jsx)(x.A,{size:24})}),(0,a.jsx)("p",{className:"text-xs font-bold",children:K("noSavedCommissions")})]})})]})]}),(0,a.jsxs)("div",{className:"lg:col-span-3 space-y-8",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsx)(Z,{label:"إجمالي المستحقات",value:eU.toLocaleString(),icon:(0,a.jsx)(h.A,{size:24}),color:"blue",isRtl:ee,suffix:"ر.س"}),(0,a.jsx)(Z,{label:"تم دفعها",value:eY.toString(),icon:(0,a.jsx)(S.A,{size:24}),color:"emerald",isRtl:ee,suffix:"موظف"}),(0,a.jsx)(Z,{label:"بانتظار الدفع",value:eI.toString(),icon:(0,a.jsx)(P.A,{size:24}),color:"amber",isRtl:ee,suffix:"موظف"})]}),(0,a.jsx)("div",{className:"bg-white rounded-[2.5rem] shadow-sm border border-gray-100 overflow-hidden min-h-[600px] flex flex-col",children:"manage"===es?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"p-8 border-b border-gray-50 flex flex-col md:flex-row md:items-center justify-between gap-6 bg-gray-50/30",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"h-12 w-12 rounded-2xl bg-blue-500/10 flex items-center justify-center text-blue-600",children:(0,a.jsx)(c.A,{size:24})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-black text-gray-900",children:K("employeeDetails")}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-0.5",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-400 font-medium",children:[eQ(eb)," • ",em]}),ez.length>0&&(0,a.jsxs)("span",{className:"bg-blue-100 text-blue-600 px-2 py-0.5 rounded-lg text-[10px] font-bold",children:[eR," / ",ez.length," مختار"]})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[ez.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsx)(z.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 group-focus-within:text-blue-500 transition-colors",size:16}),(0,a.jsx)("input",{type:"text",placeholder:"بحث بالاسم أو الكود...",value:ey,onChange:e=>ef(e.target.value),className:"pl-10 pr-4 py-2.5 rounded-xl border border-gray-200 bg-white focus:border-blue-500 focus:ring-4 focus:ring-blue-500/5 outline-none font-bold text-xs transition-all w-64"}),ey&&(0,a.jsx)("button",{onClick:()=>ef(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:(0,a.jsx)(f.A,{size:14})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{onClick:eO,className:"px-4 py-2.5 rounded-xl bg-white text-gray-700 font-black text-[10px] border border-gray-200 hover:bg-gray-50 transition-all flex items-center gap-2 shadow-sm",title:eG.every(e=>e.selected)?"إلغاء تحديد الكل":"تحديد الكل",children:[eG.every(e=>e.selected)?(0,a.jsx)(F.A,{size:16,className:"text-blue-500"}):(0,a.jsx)(L.A,{size:16}),(0,a.jsx)("span",{children:eG.every(e=>e.selected)?"إلغاء الكل":"تحديد الكل"})]}),(0,a.jsxs)("button",{onClick:()=>{eA(e=>e.filter(e=>e.selected))},disabled:eR===ez.length||0===eR,className:"px-4 py-2.5 rounded-xl bg-red-50 text-red-600 font-black text-[10px] border border-red-100 hover:bg-red-100 transition-all flex items-center gap-2 shadow-sm disabled:opacity-50",children:[(0,a.jsx)(d.A,{size:16}),(0,a.jsx)("span",{children:"حذف غير المختار"})]}),(0,a.jsxs)("button",{onClick:()=>eM(),className:"px-4 py-2.5 rounded-xl bg-white text-gray-700 font-black text-[10px] border border-gray-200 hover:bg-gray-50 transition-all flex items-center gap-2 shadow-sm",children:[(0,a.jsx)(T.A,{size:16}),(0,a.jsx)("span",{children:"تحديث"})]})]})]}),(0,a.jsxs)("button",{onClick:eq,disabled:ei||0===ez.length||0===eR,className:"px-8 py-3.5 rounded-2xl bg-emerald-500 text-white font-black text-sm shadow-xl shadow-emerald-100 hover:bg-emerald-600 active:scale-95 transition-all disabled:opacity-50 flex items-center gap-2 ml-auto",children:[ei?(0,a.jsx)(y.A,{size:18,className:"animate-spin"}):(0,a.jsx)(x.A,{size:18}),(0,a.jsx)("span",{children:K("saveData")})]})]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-x-auto",children:ez.length>0?(0,a.jsxs)("table",{className:"w-full border-collapse",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-gray-50/50",children:[(0,a.jsx)("th",{className:"px-6 py-5 text-center text-xs font-black text-gray-400 border-b border-gray-50 w-10",children:(0,a.jsx)("input",{type:"checkbox",checked:eG.length>0&&eG.every(e=>e.selected),onChange:eO,className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 cursor-pointer"})}),(0,a.jsx)("th",{className:"px-6 py-5 text-right text-xs font-black text-gray-400 uppercase tracking-widest border-b border-gray-50",children:"الموظف"}),(0,a.jsx)("th",{className:"px-6 py-5 text-center text-xs font-black text-gray-400 uppercase tracking-widest border-b border-gray-50",children:"تاريخ البداية"}),"fixed_daily"===eb&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("th",{className:"px-6 py-5 text-center text-xs font-black text-gray-400 uppercase tracking-widest border-b border-gray-50",children:K("dailyAmount")}),(0,a.jsx)("th",{className:"px-6 py-5 text-center text-xs font-black text-gray-400 uppercase tracking-widest border-b border-gray-50",children:K("days")}),(0,a.jsx)("th",{className:"px-6 py-5 text-center text-xs font-black text-gray-400 uppercase tracking-widest border-b border-gray-50",children:K("total")})]}),"fixed_monthly"===eb&&(0,a.jsx)("th",{className:"px-6 py-5 text-center text-xs font-black text-gray-400 uppercase tracking-widest border-b border-gray-50",children:"المبلغ الشهري"}),"percentage"===eb&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("th",{className:"px-6 py-5 text-center text-xs font-black text-gray-400 uppercase tracking-widest border-b border-gray-50",children:K("commissionPercent")}),(0,a.jsx)("th",{className:"px-6 py-5 text-center text-xs font-black text-gray-400 uppercase tracking-widest border-b border-gray-50",children:K("revenue")}),(0,a.jsx)("th",{className:"px-6 py-5 text-center text-xs font-black text-gray-400 uppercase tracking-widest border-b border-gray-50",children:K("commission")})]}),(0,a.jsx)("th",{className:"px-6 py-5 text-center text-xs font-black text-gray-400 uppercase tracking-widest border-b border-gray-50",children:K("deductions")}),(0,a.jsx)("th",{className:"px-6 py-5 text-center text-xs font-black text-gray-400 uppercase tracking-widest border-b border-gray-50",children:K("bonuses")}),(0,a.jsx)("th",{className:"px-6 py-5 text-center text-xs font-black text-gray-400 uppercase tracking-widest border-b border-gray-50",children:"الإجمالي"}),(0,a.jsx)("th",{className:"px-6 py-5 text-center text-xs font-black text-gray-400 uppercase tracking-widest border-b border-gray-50",children:K("paymentStatus")})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-50",children:eG.map((e,t)=>{let s=(e=>{let t=eG[e];return ez.findIndex(e=>e.employee_id===t.employee_id)})(t),r=(eb.startsWith("fixed")?Number(e.total):Number(e.commission))+(Number(e.bonus)||0)-(Number(e.deduction)||0);return(0,a.jsxs)(i.P.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05*t},className:(0,G.cn)("hover:bg-blue-50/30 transition-colors",!e.selected&&"bg-gray-50/50 opacity-60"),children:[(0,a.jsx)("td",{className:"px-6 py-4 text-center",children:(0,a.jsx)("input",{type:"checkbox",checked:e.selected,onChange:e=>eD(s,"selected",e.target.checked),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 cursor-pointer"})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"font-black text-gray-900 text-sm",children:e.name}),(0,a.jsxs)("span",{className:"text-[10px] text-gray-400 font-bold mt-0.5 tracking-tighter",children:[e.user_code," • ",e.iqama_number]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 text-center",children:(0,a.jsx)("input",{type:"date",value:e.start_date,onChange:e=>eD(s,"start_date",e.target.value),className:"w-32 px-3 py-2 rounded-xl border border-gray-100 bg-gray-50/50 focus:bg-white focus:border-blue-500 outline-none text-xs font-bold transition-all"})}),"fixed_daily"===eb&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("td",{className:"px-6 py-4 text-center",children:(0,a.jsx)("input",{type:"number",value:e.daily_amount,onChange:e=>eD(s,"daily_amount",e.target.value),className:"w-24 px-3 py-2 rounded-xl border border-gray-100 bg-gray-50/50 text-center focus:bg-white focus:border-blue-500 outline-none text-xs font-black transition-all"})}),(0,a.jsx)("td",{className:"px-6 py-4 text-center",children:(0,a.jsx)("input",{type:"number",value:e.days,onChange:e=>eD(s,"days",e.target.value),className:"w-20 px-3 py-2 rounded-xl border border-gray-100 bg-gray-50/50 text-center focus:bg-white focus:border-blue-500 outline-none text-xs font-black transition-all"})}),(0,a.jsx)("td",{className:"px-6 py-4 text-center",children:(0,a.jsx)("span",{className:"font-black text-sm text-blue-600",children:Number(e.total||0).toFixed(2)})})]}),"fixed_monthly"===eb&&(0,a.jsx)("td",{className:"px-6 py-4 text-center",children:(0,a.jsx)("input",{type:"number",value:e.daily_amount,onChange:e=>eD(s,"daily_amount",e.target.value),className:"w-32 px-3 py-2 rounded-xl border border-gray-100 bg-gray-50/50 text-center focus:bg-white focus:border-blue-500 outline-none text-xs font-black transition-all"})}),"percentage"===eb&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("td",{className:"px-6 py-4 text-center",children:(0,a.jsxs)("div",{className:"relative inline-block",children:[(0,a.jsx)("input",{type:"number",value:e.percentage,onChange:e=>eD(s,"percentage",e.target.value),className:"w-24 px-3 py-2 rounded-xl border border-gray-100 bg-gray-50/50 text-center focus:bg-white focus:border-blue-500 outline-none text-xs font-black transition-all pr-6"}),(0,a.jsx)("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 text-[10px]",children:"%"})]})}),(0,a.jsx)("td",{className:"px-6 py-4 text-center",children:(0,a.jsx)("input",{type:"number",value:e.revenue,onChange:e=>eD(s,"revenue",e.target.value),className:"w-28 px-3 py-2 rounded-xl border border-gray-100 bg-gray-50/50 text-center focus:bg-white focus:border-blue-500 outline-none text-xs font-black transition-all"})}),(0,a.jsx)("td",{className:"px-6 py-4 text-center",children:(0,a.jsx)("span",{className:"font-black text-sm text-blue-600",children:Number(e.commission||0).toFixed(2)})})]}),(0,a.jsx)("td",{className:"px-6 py-4 text-center",children:(0,a.jsx)("input",{type:"number",value:e.deduction,onChange:e=>eD(s,"deduction",e.target.value),className:"w-24 px-3 py-2 rounded-xl border border-gray-100 bg-gray-50/50 text-center focus:bg-white focus:border-blue-500 outline-none text-xs font-black text-red-500 transition-all"})}),(0,a.jsx)("td",{className:"px-6 py-4 text-center",children:(0,a.jsx)("input",{type:"number",value:e.bonus,onChange:e=>eD(s,"bonus",e.target.value),className:"w-24 px-3 py-2 rounded-xl border border-gray-100 bg-gray-50/50 text-center focus:bg-white focus:border-blue-500 outline-none text-xs font-black text-emerald-500 transition-all"})}),(0,a.jsx)("td",{className:"px-6 py-4 text-center",children:(0,a.jsx)("span",{className:"font-black text-sm text-gray-900",children:r.toFixed(2)})}),(0,a.jsx)("td",{className:"px-6 py-4 text-center",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,a.jsx)("button",{onClick:()=>eD(s,"status","paid"===e.status?"unpaid":"paid"),className:(0,G.cn)("w-10 h-5 rounded-full relative transition-all duration-300 shadow-inner group/toggle","paid"===e.status?"bg-emerald-500":"bg-gray-300"),children:(0,a.jsx)("div",{className:(0,G.cn)("absolute top-0.5 w-4 h-4 bg-white rounded-full transition-all shadow-md group-hover/toggle:scale-110","paid"===e.status?"right-0.5":"left-0.5")})}),(0,a.jsx)("span",{className:(0,G.cn)("text-[8px] font-black","paid"===e.status?"text-emerald-600":"text-gray-400"),children:"paid"===e.status?"تم الدفع":"معلق"})]})})]},e.employee_id)})})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-32 opacity-20 grayscale",children:[(0,a.jsx)("div",{className:"h-24 w-24 rounded-full bg-gray-100 flex items-center justify-center mb-6",children:(0,a.jsx)(c.A,{size:48})}),(0,a.jsx)("p",{className:"font-black text-lg",children:"لم يتم اختيار باقة أو لا يوجد موظفين"})]})})]}):(0,a.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,a.jsxs)("div",{className:"p-8 border-b border-gray-50 flex flex-col md:flex-row md:items-center justify-between gap-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"h-12 w-12 rounded-2xl bg-amber-500/10 flex items-center justify-center text-amber-600",children:(0,a.jsx)(E.A,{size:24})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-black text-gray-900",children:K("report.title")}),(0,a.jsx)("p",{className:"text-sm text-gray-400 font-medium",children:K("report.subtitle")})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{onClick:()=>eF(),className:"px-6 py-2.5 rounded-xl bg-white text-gray-700 font-black text-sm border border-gray-200 hover:bg-gray-50 active:scale-95 transition-all flex items-center gap-2 shadow-sm",children:[(0,a.jsx)(u.A,{size:18}),(0,a.jsx)("span",{children:K("report.print")})]}),(0,a.jsxs)("button",{className:"px-6 py-2.5 rounded-xl bg-[#1d6f42] text-white font-black text-sm hover:bg-[#165a35] active:scale-95 transition-all flex items-center gap-2 shadow-xl shadow-green-100",children:[(0,a.jsx)(M.A,{size:18}),(0,a.jsx)("span",{children:"Excel"})]})]})]}),(0,a.jsx)("div",{className:"flex-1 p-8 overflow-auto",ref:eP,children:(0,a.jsxs)("div",{className:"space-y-10 print:space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 p-8 rounded-3xl bg-gray-900 text-white shadow-2xl relative overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1 relative z-10",children:[(0,a.jsx)("span",{className:"text-[10px] text-white/40 uppercase font-black tracking-[0.2em]",children:K("month")}),(0,a.jsx)("span",{className:"text-lg font-black",children:em})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-1 relative z-10 border-r border-white/10 pr-6",children:[(0,a.jsx)("span",{className:"text-[10px] text-white/40 uppercase font-black tracking-[0.2em]",children:"إجمالي المستحقات"}),(0,a.jsxs)("span",{className:"text-lg font-black text-blue-400",children:[eU.toLocaleString()," ",(0,a.jsx)("span",{className:"text-xs opacity-50",children:"ر.س"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-1 relative z-10 border-r border-white/10 pr-6",children:[(0,a.jsx)("span",{className:"text-[10px] text-white/40 uppercase font-black tracking-[0.2em]",children:"الموظفين المشمولين"}),(0,a.jsxs)("span",{className:"text-lg font-black",children:[ez.length," ",(0,a.jsx)("span",{className:"text-xs opacity-50",children:"موظف"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-1 relative z-10 border-r border-white/10 pr-6",children:[(0,a.jsx)("span",{className:"text-[10px] text-white/40 uppercase font-black tracking-[0.2em]",children:"نوع العمولات"}),(0,a.jsx)("span",{className:"text-lg font-black text-emerald-400",children:eQ(eb)})]}),(0,a.jsx)("div",{className:"absolute top-0 right-0 w-32 h-full bg-gradient-to-l from-white/5 to-transparent pointer-events-none"})]}),(0,a.jsx)("div",{className:"rounded-3xl border border-gray-100 overflow-hidden",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-gray-50 border-b border-gray-100",children:[(0,a.jsx)("th",{className:"px-6 py-5 text-right text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"الموظف"}),(0,a.jsx)("th",{className:"px-6 py-5 text-center text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"تاريخ البداية"}),(0,a.jsx)("th",{className:"px-6 py-5 text-center text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"العمولة المستحقة"}),(0,a.jsx)("th",{className:"px-6 py-5 text-center text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"المكافآت (+)"}),(0,a.jsx)("th",{className:"px-6 py-5 text-center text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"الخصومات (-)"}),(0,a.jsx)("th",{className:"px-6 py-5 text-center text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"الصافي النهائي"}),(0,a.jsx)("th",{className:"px-6 py-5 text-center text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"الحالة"}),(0,a.jsx)("th",{className:"px-6 py-5 text-center text-[10px] font-black text-gray-400 uppercase tracking-widest print:hidden",children:"إجراءات"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-50",children:ez.map((e,t)=>{let s=(eb.startsWith("fixed")?Number(e.total):Number(e.commission))+Number(e.bonus)-Number(e.deduction);return(0,a.jsxs)("tr",{className:"hover:bg-gray-50/50",children:[(0,a.jsx)("td",{className:"px-6 py-5 font-black text-gray-900 text-sm",children:(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{children:e.name}),(0,a.jsx)("span",{className:"text-[10px] text-gray-400 font-bold",children:e.user_code})]})}),(0,a.jsx)("td",{className:"px-6 py-5 text-center font-medium text-gray-500 text-xs",children:e.start_date||"-"}),(0,a.jsx)("td",{className:"px-6 py-5 text-center font-black text-blue-600",children:(eb.startsWith("fixed")?Number(e.total):Number(e.commission)).toLocaleString()}),(0,a.jsx)("td",{className:"px-6 py-5 text-center font-black text-emerald-500",children:(Number(e.bonus)||0).toLocaleString()}),(0,a.jsx)("td",{className:"px-6 py-5 text-center font-black text-red-500",children:(Number(e.deduction)||0).toLocaleString()}),(0,a.jsx)("td",{className:"px-6 py-5 text-center bg-gray-50/50",children:(0,a.jsx)("span",{className:"font-black text-gray-900 text-base",children:s.toLocaleString()})}),(0,a.jsx)("td",{className:"px-6 py-5 text-center",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-1.5",children:[(0,a.jsx)("button",{onClick:()=>eD(t,"status","paid"===e.status?"unpaid":"paid"),className:(0,G.cn)("w-12 h-6 rounded-full relative transition-all duration-300 shadow-inner group/toggle","paid"===e.status?"bg-emerald-500":"bg-gray-300"),children:(0,a.jsx)("div",{className:(0,G.cn)("absolute top-1 w-4 h-4 bg-white rounded-full transition-all shadow-md group-hover/toggle:scale-110","paid"===e.status?"right-1":"left-1")})}),(0,a.jsx)("span",{className:(0,G.cn)("text-[9px] font-black uppercase tracking-widest","paid"===e.status?"text-emerald-600":"text-gray-400"),children:"paid"===e.status?"تم الدفع":"معلق"})]})}),(0,a.jsx)("td",{className:"px-6 py-5 text-center print:hidden",children:(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>(e=>{if(!e.id)return void eL("error","يجب حفظ التقرير أولاً قبل إرسال السند");ex({show:!0,commission:e,email:e.email||""})})(e),disabled:ec===e.id,className:(0,G.cn)("p-2 rounded-xl transition-all shadow-sm","paid"===e.status?"bg-emerald-50 text-emerald-600 hover:bg-emerald-600 hover:text-white":"bg-red-50 text-red-600 hover:bg-red-600 hover:text-white"),title:"paid"===e.status?"إرسال سند سداد":"إرسال مطالبة مالية",children:ec===e.id?(0,a.jsx)(y.A,{size:16,className:"animate-spin"}):(0,a.jsx)(p.A,{size:16})}),(0,a.jsx)("button",{onClick:()=>eF(),className:"p-2 rounded-xl bg-gray-50 text-gray-600 hover:bg-gray-600 hover:text-white transition-all shadow-sm",title:"طباعة السند",children:(0,a.jsx)(u.A,{size:16})})]})})]},e.employee_id)})})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-12 pt-16 mt-16 border-t border-dashed border-gray-200 opacity-0 print:opacity-100 h-0 print:h-auto overflow-hidden",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("span",{className:"text-[10px] text-gray-400 font-black uppercase tracking-widest block mb-12",children:"توقيع المحاسب"}),(0,a.jsx)("div",{className:"w-48 h-px bg-gray-200 mx-auto"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("span",{className:"text-[10px] text-gray-400 font-black uppercase tracking-widest block mb-12",children:"اعتماد المدير"}),(0,a.jsx)("div",{className:"w-48 h-px bg-gray-200 mx-auto"})]})]})]})})]})})]})]})]})}function Z(e){let{label:t,value:s,icon:r,color:l,isRtl:i,suffix:n}=e,c={blue:"bg-blue-500 text-blue-600 shadow-blue-100 border-blue-100",emerald:"bg-emerald-500 text-emerald-600 shadow-emerald-100 border-emerald-100",amber:"bg-amber-500 text-amber-600 shadow-amber-100 border-amber-100"};return(0,a.jsxs)("div",{className:"bg-white rounded-[2rem] p-6 shadow-sm border border-gray-100 flex items-center gap-6 group hover:shadow-xl hover:-translate-y-1 transition-all duration-500",children:[(0,a.jsx)("div",{className:(0,G.cn)("h-16 w-16 rounded-2xl flex items-center justify-center shrink-0 transition-transform duration-500 group-hover:rotate-12 group-hover:scale-110",c[l].replace("text-","bg-").replace("shadow-","shadow-").split(" ")[0]+"/10",c[l].split(" ")[1]),children:r}),(0,a.jsxs)("div",{className:"flex flex-col gap-1 overflow-hidden",children:[(0,a.jsx)("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] truncate",children:t}),(0,a.jsxs)("div",{className:"flex items-baseline gap-1.5",children:[(0,a.jsx)("span",{className:"text-2xl font-black text-gray-900 tracking-tighter",children:s}),n&&(0,a.jsx)("span",{className:"text-xs font-bold text-gray-400",children:n})]})]})]})}},51834:(e,t,s)=>{"use strict";s.d(t,{Cf:()=>x,Es:()=>p,L3:()=>u,c7:()=>m,lG:()=>n,rr:()=>h,zM:()=>c});var a=s(95155);s(12115);var r=s(93409),l=s(65229),i=s(64269);function n(e){let{...t}=e;return(0,a.jsx)(r.bL,{"data-slot":"dialog",...t})}function c(e){let{...t}=e;return(0,a.jsx)(r.l9,{"data-slot":"dialog-trigger",...t})}function o(e){let{...t}=e;return(0,a.jsx)(r.ZL,{"data-slot":"dialog-portal",...t})}function d(e){let{className:t,...s}=e;return(0,a.jsx)(r.hJ,{"data-slot":"dialog-overlay",className:(0,i.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function x(e){let{className:t,children:s,showCloseButton:n=!0,...c}=e;return(0,a.jsxs)(o,{"data-slot":"dialog-portal",children:[(0,a.jsx)(d,{}),(0,a.jsxs)(r.UC,{"data-slot":"dialog-content",className:(0,i.cn)("bg-white data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...c,children:[s,n&&(0,a.jsxs)(r.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(l.A,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function m(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-header",className:(0,i.cn)("flex flex-col gap-2 text-center sm:text-left",t),...s})}function p(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-footer",className:(0,i.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...s})}function u(e){let{className:t,...s}=e;return(0,a.jsx)(r.hE,{"data-slot":"dialog-title",className:(0,i.cn)("text-lg leading-none font-semibold",t),...s})}function h(e){let{className:t,...s}=e;return(0,a.jsx)(r.VY,{"data-slot":"dialog-description",className:(0,i.cn)("text-muted-foreground text-sm",t),...s})}},64269:(e,t,s)=>{"use strict";s.d(t,{cn:()=>l});var a=s(2821),r=s(75889);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.QP)((0,a.$)(t))}},96044:(e,t,s)=>{Promise.resolve().then(s.bind(s,15879))}},e=>{e.O(0,[2418,4909,2619,6550,315,317,8234,1508,3884,8441,1255,7358],()=>e(e.s=96044)),_N_E=e.O()}]);