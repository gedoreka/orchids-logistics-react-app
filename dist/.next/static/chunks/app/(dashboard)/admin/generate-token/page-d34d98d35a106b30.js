(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6348],{8143:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>U});var a=t(95155),r=t(12115),l=t(26497),n=t(8751),i=t(19408),o=t(46826),d=t(5370),c=t(86651),m=t(85998),x=t(37586),g=t(48055),h=t(91169),y=t(60167),b=t(53409),p=t(89715),u=t(78519),f=t(24722),j=t(24947),N=t(55136),v=t(16485),k=t(46398),w=t(26617),_=t(42041),A=t(80534),z=t(97079),S=t(87454),C=t(47937),E=t(92927),R=t(85843),P=t(80647),T=t(23664),O=t(17910),q=t(42529),F=t(75426),I=t(26983),B=t(37107),D=t(68854),J=t(69152),Q=t(39068),$=t(95740),G=t(89559),H=t(18720),K=t(64269);let L=[{key:"admin_requests",name:"طلبات تسجيل المنشآت",icon:i.A,type:"admin"},{key:"admin_create_company",name:"إضافة منشأة جديدة",icon:o.A,type:"admin"},{key:"admin_generate_token",name:"توليد رمز الاشتراك",icon:d.A,type:"admin"},{key:"admin_search_token",name:"البحث عن رمز الاشتراك",icon:c.A,type:"admin"},{key:"admin_notifications",name:"إشعارات المدير",icon:m.A,type:"admin"},{key:"admin_chat",name:"الدعم الفني",icon:x.A,type:"admin"},{key:"special_salaries",name:"مسيرات رواتب خاص",icon:g.A,type:"admin"},{key:"employees_module",name:"إدارة الموارد البشرية",icon:h.A,type:"general",category:"الموارد البشرية"},{key:"salary_payrolls_module",name:"مسيرات الرواتب",icon:y.A,type:"general",category:"الموارد البشرية"},{key:"clients_module",name:"قائمة العملاء",icon:h.A,type:"general",category:"العملاء والمبيعات"},{key:"receipts_module",name:"السندات المالية",icon:b.A,type:"general",category:"السندات المالية"},{key:"quotations_module",name:"عروض الأسعار",icon:p.A,type:"general",category:"السندات المالية"},{key:"sales_module",name:"الفواتير الضريبية",icon:p.A,type:"general",category:"السندات المالية"},{key:"income_module",name:"إضافة دخل جديد",icon:g.A,type:"general",category:"السندات المالية"},{key:"credit_notes_module",name:"إشعارات الدائن الضريبية",icon:u.A,type:"general",category:"السندات المالية"},{key:"receipt_vouchers_module",name:"سندات القبض",icon:f.A,type:"general",category:"السندات المالية"},{key:"vehicles_list",name:"إدارة المركبات",icon:j.A,type:"general",category:"إدارة الأسطول"},{key:"ecommerce_orders_module",name:"طلبات التجارة الإلكترونية",icon:N.A,type:"general",category:"التجارة الإلكترونية"},{key:"daily_orders_module",name:"عرض الطلبات اليومية",icon:v.A,type:"general",category:"التجارة الإلكترونية"},{key:"ecommerce_stores_module",name:"إدارة المتاجر",icon:N.A,type:"general",category:"التجارة الإلكترونية"},{key:"personal_shipments_module",name:"شحنات الأفراد",icon:k.A,type:"general",category:"الشحن"},{key:"manage_shipments_module",name:"إدارة شحنات الأفراد",icon:w.A,type:"general",category:"الشحن"},{key:"monthly_commissions_module",name:"العمولة الشهرية",icon:_.A,type:"general",category:"العمولات"},{key:"commissions_summary_module",name:"تقرير العمولة الشهرية",icon:f.A,type:"general",category:"العمولات"},{key:"expenses_module",name:"المصروفات الشهرية",icon:A.A,type:"general",category:"المحاسبة"},{key:"journal_entries_module",name:"قيود اليومية",icon:z.A,type:"general",category:"المحاسبة"},{key:"income_report_module",name:"عرض الدخل والتقارير",icon:S.A,type:"general",category:"المحاسبة"},{key:"expenses_report_module",name:"تقرير المصروفات",icon:A.A,type:"general",category:"المحاسبة"},{key:"accounts_module",name:"مركز الحسابات",icon:C.A,type:"general",category:"الحسابات"},{key:"cost_centers_module",name:"مراكز التكلفة",icon:E.A,type:"general",category:"الحسابات"},{key:"ledger_module",name:"دفتر الأستاذ العام",icon:C.A,type:"general",category:"الحسابات"},{key:"trial_balance_module",name:"ميزان المراجعة",icon:R.A,type:"general",category:"الحسابات"},{key:"income_statement_module",name:"قائمة الأرصدة",icon:A.A,type:"general",category:"الحسابات"},{key:"balance_sheet_module",name:"الميزانية العمومية",icon:p.A,type:"general",category:"الحسابات"},{key:"tax_settings_module",name:"إعدادات الضريبة",icon:P.A,type:"general",category:"الحسابات"},{key:"letters_templates_module",name:"الخطابات الجاهزة",icon:T.A,type:"general",category:"أخرى"}],M={"الموارد البشرية":{bg:"from-blue-500/10 to-blue-600/5",border:"border-r-blue-500",icon:"text-blue-500"},"العملاء والمبيعات":{bg:"from-cyan-500/10 to-cyan-600/5",border:"border-r-cyan-500",icon:"text-cyan-500"},"السندات المالية":{bg:"from-indigo-500/10 to-indigo-600/5",border:"border-r-indigo-500",icon:"text-indigo-500"},"إدارة الأسطول":{bg:"from-amber-500/10 to-amber-600/5",border:"border-r-amber-500",icon:"text-amber-500"},"التجارة الإلكترونية":{bg:"from-pink-500/10 to-pink-600/5",border:"border-r-pink-500",icon:"text-pink-500"},الشحن:{bg:"from-sky-500/10 to-sky-600/5",border:"border-r-sky-500",icon:"text-sky-500"},العمولات:{bg:"from-orange-500/10 to-orange-600/5",border:"border-r-orange-500",icon:"text-orange-500"},المحاسبة:{bg:"from-emerald-500/10 to-emerald-600/5",border:"border-r-emerald-500",icon:"text-emerald-500"},الحسابات:{bg:"from-violet-500/10 to-violet-600/5",border:"border-r-violet-500",icon:"text-violet-500"},أخرى:{bg:"from-slate-500/10 to-slate-600/5",border:"border-r-slate-500",icon:"text-slate-500"}};function U(){var e;let[s,t]=(0,r.useState)([]),[o,c]=(0,r.useState)(""),[m,x]=(0,r.useState)(30),[g,h]=(0,r.useState)(!1),[y,b]=(0,r.useState)(!0),[p,u]=(0,r.useState)(new Set),[f,j]=(0,r.useState)(null),[N,k]=(0,r.useState)(null),w=L.filter(e=>"admin"===e.type),_=L.filter(e=>"general"===e.type),A=Array.from(new Set(_.map(e=>e.category)));(0,r.useEffect)(()=>{z()},[]);let z=async()=>{try{let e=await fetch("/api/admin/companies"),s=await e.json(),a=Array.isArray(s)?s:s.companies||[];t(a)}catch(e){console.error("Error fetching companies:",e),H.oR.error("فشل في تحميل الشركات")}finally{b(!1)}},S=e=>{let s=new Set(p);s.has(e)?s.delete(e):s.add(e),u(s)},C=async()=>{if(!o)return void H.oR.error("الرجاء اختيار الشركة");if(0===p.size)return void H.oR.error("الرجاء اختيار صلاحية واحدة على الأقل");h(!0);try{let e=await fetch("/api/admin/generate-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({company_id:o,days:m,features:Array.from(p)})}),s=await e.json();e.ok?(j(s.token),k(s.expiry),H.oR.success("تم توليد رمز الاشتراك بنجاح!")):H.oR.error(s.error||"حدث خطأ أثناء توليد الرمز")}catch(e){H.oR.error("حدث خطأ غير متوقع")}finally{h(!1)}};return(0,a.jsx)("div",{className:"p-6 md:p-8 bg-slate-50 min-h-screen",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl p-6 text-white shadow-xl",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-14 h-14 rounded-xl bg-amber-500/20 flex items-center justify-center",children:(0,a.jsx)(d.A,{size:28,className:"text-amber-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-black",children:"توليد رمز الاشتراك"}),(0,a.jsx)("p",{className:"text-slate-400 text-sm",children:"إنشاء رمز تفعيل جديد مع الصلاحيات المحددة"})]})]}),(0,a.jsxs)("div",{className:"flex gap-4 mt-4",children:[(0,a.jsxs)("div",{className:"bg-white/10 px-4 py-2 rounded-xl flex items-center gap-2",children:[(0,a.jsx)(i.A,{size:16,className:"text-indigo-400"}),(0,a.jsxs)("span",{className:"text-sm",children:[s.length," شركة نشطة"]})]}),(0,a.jsxs)("div",{className:"bg-white/10 px-4 py-2 rounded-xl flex items-center gap-2",children:[(0,a.jsx)(O.A,{size:16,className:"text-emerald-400"}),(0,a.jsxs)("span",{className:"text-sm",children:[L.length," صلاحية متاحة"]})]})]})]}),(0,a.jsx)(l.N,{children:f&&(0,a.jsx)(n.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-gradient-to-r from-emerald-500 to-teal-600 rounded-2xl p-6 text-white shadow-xl",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(q.A,{size:40,className:"mx-auto mb-3"}),(0,a.jsx)("h3",{className:"text-lg font-bold mb-4",children:"تم توليد الرمز بنجاح!"}),(0,a.jsxs)("div",{className:"bg-white/20 backdrop-blur rounded-xl p-4 mb-4",children:[(0,a.jsx)("p",{className:"text-xs text-white/70 mb-2",children:"رمز التفعيل"}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-3",children:[(0,a.jsx)("code",{className:"text-2xl font-mono font-bold tracking-widest",children:f}),(0,a.jsx)("button",{onClick:()=>{f&&(navigator.clipboard.writeText(f),H.oR.success("تم نسخ الرمز!"))},className:"p-2 bg-white/20 rounded-lg hover:bg-white/30 transition-all",children:(0,a.jsx)(F.A,{size:18})})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 text-white/80",children:[(0,a.jsx)(I.A,{size:16}),(0,a.jsxs)("span",{children:["صالح حتى: ",N]})]})]})})}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-6 pb-4 border-b border-slate-100",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-xl bg-indigo-100 flex items-center justify-center",children:(0,a.jsx)(i.A,{size:20,className:"text-indigo-600"})}),(0,a.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:"معلومات الاشتراك"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-bold text-slate-700 mb-2 flex items-center gap-2",children:[(0,a.jsx)(i.A,{size:14,className:"text-indigo-500"}),"اختر الشركة"]}),(0,a.jsxs)("select",{value:o,onChange:e=>c(e.target.value),disabled:y,className:"w-full px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/20 transition-all text-slate-800 bg-white",children:[(0,a.jsx)("option",{value:"",children:"-- اختر الشركة --"}),s.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," (ID: ",e.id,")"]},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-bold text-slate-700 mb-2 flex items-center gap-2",children:[(0,a.jsx)(v.A,{size:14,className:"text-indigo-500"}),"مدة التفعيل (أيام)"]}),(0,a.jsx)("input",{type:"number",value:m,onChange:e=>x(parseInt(e.target.value)||0),min:0,className:"w-full px-4 py-3 rounded-xl border-2 border-slate-200 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/20 transition-all text-slate-800",placeholder:"30"}),(0,a.jsxs)("p",{className:"text-xs text-slate-400 mt-1 flex items-center gap-1",children:[(0,a.jsx)(B.A,{size:12}),"أدخل 0 للتفعيل الدائم"]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 mb-6 pb-4 border-b border-slate-100",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-xl bg-rose-100 flex items-center justify-center",children:(0,a.jsx)(D.A,{size:20,className:"text-rose-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:"الصلاحيات الإدارية"}),(0,a.jsx)("span",{className:"text-xs text-slate-500",children:"صلاحيات متقدمة"})]})]}),(0,a.jsxs)("button",{type:"button",onClick:()=>{let e=w.map(e=>e.key),s=e.every(e=>p.has(e)),t=new Set(p);s?e.forEach(e=>t.delete(e)):e.forEach(e=>t.add(e)),u(t)},className:"flex items-center gap-2 bg-slate-100 hover:bg-slate-200 px-3 py-1.5 rounded-lg text-xs font-bold transition-all",children:[(0,a.jsx)(J.A,{size:14}),"تحديد الكل"]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:w.map(e=>(0,a.jsx)(n.P.div,{whileTap:{scale:.98},onClick:()=>S(e.key),className:(0,K.cn)("cursor-pointer rounded-xl p-4 border-2 transition-all duration-200",p.has(e.key)?"bg-rose-50 border-rose-300":"bg-white border-slate-200 hover:border-slate-300"),children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:(0,K.cn)("w-9 h-9 rounded-lg flex items-center justify-center transition-all",p.has(e.key)?"bg-rose-500 text-white":"bg-slate-100 text-slate-500"),children:(0,a.jsx)(e.icon,{size:18})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"font-bold text-slate-800 text-sm truncate",children:e.name}),(0,a.jsxs)("span",{className:"text-xs text-rose-500 flex items-center gap-1",children:[(0,a.jsx)(O.A,{size:10}),"إداري"]})]}),(0,a.jsx)("div",{className:(0,K.cn)("w-10 h-5 rounded-full transition-all duration-200 relative flex-shrink-0",p.has(e.key)?"bg-emerald-500":"bg-slate-300"),children:(0,a.jsx)("div",{className:(0,K.cn)("absolute top-0.5 w-4 h-4 rounded-full bg-white shadow transition-all duration-200",p.has(e.key)?"right-0.5":"left-0.5")})})]})},e.key))})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 mb-6 pb-4 border-b border-slate-100",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-xl bg-emerald-100 flex items-center justify-center",children:(0,a.jsx)(Q.A,{size:20,className:"text-emerald-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:"الصلاحيات العامة"}),(0,a.jsx)("span",{className:"text-xs text-slate-500",children:"صلاحيات أساسية"})]})]}),(0,a.jsxs)("button",{type:"button",onClick:()=>{let e=_.map(e=>e.key),s=e.every(e=>p.has(e)),t=new Set(p);s?e.forEach(e=>t.delete(e)):e.forEach(e=>t.add(e)),u(t)},className:"flex items-center gap-2 bg-slate-100 hover:bg-slate-200 px-3 py-1.5 rounded-lg text-xs font-bold transition-all",children:[(0,a.jsx)(J.A,{size:14}),"تحديد الكل"]})]}),(0,a.jsx)("div",{className:"space-y-6",children:A.filter(Boolean).map(e=>{let s=_.filter(s=>s.category===e),t=M[e]||M["أخرى"];return(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h3",{className:"text-sm font-bold text-slate-700 flex items-center gap-2",children:[(0,a.jsx)("div",{className:(0,K.cn)("w-1.5 h-5 rounded-full",t.border.replace("border-r-","bg-"))}),e,(0,a.jsxs)("span",{className:"text-xs font-normal text-slate-400",children:["(",s.length,")"]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:s.map(s=>(0,a.jsx)(n.P.div,{whileTap:{scale:.98},onClick:()=>S(s.key),className:(0,K.cn)("cursor-pointer rounded-xl p-4 border-2 border-r-4 transition-all duration-200",t.border,p.has(s.key)?"bg-gradient-to-br ".concat(t.bg," border-emerald-300"):"bg-white border-slate-200 hover:border-slate-300"),children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:(0,K.cn)("w-9 h-9 rounded-lg flex items-center justify-center transition-all",p.has(s.key)?"bg-emerald-500 text-white":"bg-slate-100 text-slate-500"),children:(0,a.jsx)(s.icon,{size:18})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"font-bold text-slate-800 text-sm truncate",children:s.name}),(0,a.jsxs)("span",{className:(0,K.cn)("text-xs flex items-center gap-1",t.icon),children:[(0,a.jsx)($.A,{size:10}),e]})]}),(0,a.jsx)("div",{className:(0,K.cn)("w-10 h-5 rounded-full transition-all duration-200 relative flex-shrink-0",p.has(s.key)?"bg-emerald-500":"bg-slate-300"),children:(0,a.jsx)("div",{className:(0,K.cn)("absolute top-0.5 w-4 h-4 rounded-full bg-white shadow transition-all duration-200",p.has(s.key)?"right-0.5":"left-0.5")})})]})},s.key))})]},e)})})]}),(0,a.jsx)("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 shadow-sm",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"bg-indigo-100 px-4 py-2 rounded-xl",children:(0,a.jsxs)("span",{className:"text-sm text-indigo-600 font-bold",children:[p.size," صلاحية محددة"]})}),o&&(0,a.jsx)("div",{className:"bg-emerald-100 px-4 py-2 rounded-xl",children:(0,a.jsx)("span",{className:"text-sm text-emerald-600 font-bold",children:null==(e=s.find(e=>e.id.toString()===o))?void 0:e.name})})]}),(0,a.jsx)("button",{type:"button",onClick:C,disabled:g||!o||0===p.size,className:"flex items-center gap-3 bg-gradient-to-r from-amber-500 to-orange-600 text-white px-8 py-3 rounded-xl font-bold shadow-lg shadow-amber-500/30 hover:shadow-amber-500/50 hover:scale-105 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",children:g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(G.A,{className:"w-5 h-5 animate-spin"}),"جاري التوليد..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.A,{className:"w-5 h-5"}),"توليد الرمز"]})})]})})]})})}},53112:(e,s,t)=>{Promise.resolve().then(t.bind(t,8143))},64269:(e,s,t)=>{"use strict";t.d(s,{cn:()=>l});var a=t(2821),r=t(75889);function l(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,r.QP)((0,a.$)(s))}}},e=>{e.O(0,[977,4909,8720,1482,8441,1255,7358],()=>e(e.s=53112)),_N_E=e.O()}]);