(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[971],{64269:(e,t,a)=>{"use strict";a.d(t,{cn:()=>n});var r=a(2821),s=a(75889);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.QP)((0,r.$)(t))}},88105:(e,t,a)=>{Promise.resolve().then(a.bind(a,93024))},93024:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ee});var r=a(95155),s=a(12115),n=a(26497),l=a(8751),o=a(19408),i=a(46826),c=a(5370),d=a(86651),m=a(85998),x=a(37586),g=a(48055),y=a(91169),b=a(60167),p=a(53409),u=a(89715),h=a(78519),j=a(24722),f=a(24947),v=a(55136),_=a(16485),k=a(46398),N=a(26617),A=a(42041),w=a(80534),z=a(97079),C=a(87454),R=a(47937),S=a(92927),T=a(85843),E=a(80647),O=a(23664),P=a(6132),D=a(20027),q=a(42529),B=a(26983),J=a(78874),M=a(89559),U=a(53511),H=a(85921),I=a(37107),K=a(69141),L=a(21873),Q=a(75426),$=a(68854),F=a(39068),G=a(17910),V=a(95740),W=a(18720),X=a(64269);let Y=[{key:"admin_requests",name:"طلبات تسجيل المنشآت",icon:o.A,type:"admin"},{key:"admin_create_company",name:"إضافة منشأة جديدة",icon:i.A,type:"admin"},{key:"admin_generate_token",name:"توليد رمز الاشتراك",icon:c.A,type:"admin"},{key:"admin_search_token",name:"البحث عن رمز الاشتراك",icon:d.A,type:"admin"},{key:"admin_notifications",name:"إشعارات المدير",icon:m.A,type:"admin"},{key:"admin_chat",name:"الدعم الفني",icon:x.A,type:"admin"},{key:"special_salaries",name:"مسيرات رواتب خاص",icon:g.A,type:"admin"},{key:"employees_module",name:"إدارة الموارد البشرية",icon:y.A,type:"general",category:"الموارد البشرية"},{key:"salary_payrolls_module",name:"مسيرات الرواتب",icon:b.A,type:"general",category:"الموارد البشرية"},{key:"clients_module",name:"قائمة العملاء",icon:y.A,type:"general",category:"العملاء والمبيعات"},{key:"receipts_module",name:"السندات المالية",icon:p.A,type:"general",category:"السندات المالية"},{key:"quotations_module",name:"عروض الأسعار",icon:u.A,type:"general",category:"السندات المالية"},{key:"sales_module",name:"الفواتير الضريبية",icon:u.A,type:"general",category:"السندات المالية"},{key:"income_module",name:"إضافة دخل جديد",icon:g.A,type:"general",category:"السندات المالية"},{key:"credit_notes_module",name:"إشعارات الدائن الضريبية",icon:h.A,type:"general",category:"السندات المالية"},{key:"receipt_vouchers_module",name:"سندات القبض",icon:j.A,type:"general",category:"السندات المالية"},{key:"vehicles_list",name:"إدارة المركبات",icon:f.A,type:"general",category:"إدارة الأسطول"},{key:"ecommerce_orders_module",name:"طلبات التجارة الإلكترونية",icon:v.A,type:"general",category:"التجارة الإلكترونية"},{key:"daily_orders_module",name:"عرض الطلبات اليومية",icon:_.A,type:"general",category:"التجارة الإلكترونية"},{key:"ecommerce_stores_module",name:"إدارة المتاجر",icon:v.A,type:"general",category:"التجارة الإلكترونية"},{key:"personal_shipments_module",name:"شحنات الأفراد",icon:k.A,type:"general",category:"الشحن"},{key:"manage_shipments_module",name:"إدارة شحنات الأفراد",icon:N.A,type:"general",category:"الشحن"},{key:"monthly_commissions_module",name:"العمولة الشهرية",icon:A.A,type:"general",category:"العمولات"},{key:"commissions_summary_module",name:"تقرير العمولة الشهرية",icon:j.A,type:"general",category:"العمولات"},{key:"expenses_module",name:"المصروفات الشهرية",icon:w.A,type:"general",category:"المحاسبة"},{key:"journal_entries_module",name:"قيود اليومية",icon:z.A,type:"general",category:"المحاسبة"},{key:"income_report_module",name:"عرض الدخل والتقارير",icon:C.A,type:"general",category:"المحاسبة"},{key:"expenses_report_module",name:"تقرير المصروفات",icon:w.A,type:"general",category:"المحاسبة"},{key:"accounts_module",name:"مركز الحسابات",icon:R.A,type:"general",category:"الحسابات"},{key:"cost_centers_module",name:"مراكز التكلفة",icon:S.A,type:"general",category:"الحسابات"},{key:"ledger_module",name:"دفتر الأستاذ العام",icon:R.A,type:"general",category:"الحسابات"},{key:"trial_balance_module",name:"ميزان المراجعة",icon:T.A,type:"general",category:"الحسابات"},{key:"income_statement_module",name:"قائمة الأرصدة",icon:w.A,type:"general",category:"الحسابات"},{key:"balance_sheet_module",name:"الميزانية العمومية",icon:u.A,type:"general",category:"الحسابات"},{key:"tax_settings_module",name:"إعدادات الضريبة",icon:E.A,type:"general",category:"الحسابات"},{key:"letters_templates_module",name:"الخطابات الجاهزة",icon:O.A,type:"general",category:"أخرى"}],Z={"الموارد البشرية":{bg:"from-blue-500/10 to-blue-600/5",border:"border-r-blue-500",icon:"text-blue-500"},"العملاء والمبيعات":{bg:"from-cyan-500/10 to-cyan-600/5",border:"border-r-cyan-500",icon:"text-cyan-500"},"السندات المالية":{bg:"from-indigo-500/10 to-indigo-600/5",border:"border-r-indigo-500",icon:"text-indigo-500"},"إدارة الأسطول":{bg:"from-amber-500/10 to-amber-600/5",border:"border-r-amber-500",icon:"text-amber-500"},"التجارة الإلكترونية":{bg:"from-pink-500/10 to-pink-600/5",border:"border-r-pink-500",icon:"text-pink-500"},الشحن:{bg:"from-sky-500/10 to-sky-600/5",border:"border-r-sky-500",icon:"text-sky-500"},العمولات:{bg:"from-orange-500/10 to-orange-600/5",border:"border-r-orange-500",icon:"text-orange-500"},المحاسبة:{bg:"from-emerald-500/10 to-emerald-600/5",border:"border-r-emerald-500",icon:"text-emerald-500"},الحسابات:{bg:"from-violet-500/10 to-violet-600/5",border:"border-r-violet-500",icon:"text-violet-500"},أخرى:{bg:"from-slate-500/10 to-slate-600/5",border:"border-r-slate-500",icon:"text-slate-500"}};function ee(){let[e,t]=(0,s.useState)(""),[a,i]=(0,s.useState)(null),[m,x]=(0,s.useState)({}),[g,y]=(0,s.useState)(!1),[b,p]=(0,s.useState)(""),[h,j]=(0,s.useState)(null),f=Y.filter(e=>"admin"===e.type),v=Y.filter(e=>"general"===e.type),k=Array.from(new Set(v.map(e=>e.category))),N=async()=>{if(!e.trim())return void W.oR.error("الرجاء إدخال رمز الاشتراك");y(!0),p(""),i(null),x({});try{let t=await fetch("/api/admin/search-token?token=".concat(encodeURIComponent(e.trim()))),a=await t.json();t.ok&&a.company?(i(a.company),x(a.permissions||{}),W.oR.success("تم العثور على الشركة!")):(p(a.error||"لم يتم العثور على رمز الاشتراك"),W.oR.error("لم يتم العثور على رمز الاشتراك"))}catch(e){p("حدث خطأ أثناء البحث"),W.oR.error("حدث خطأ أثناء البحث")}finally{y(!1)}},A=async e=>{if(!a)return;j(e);let t=!m[e];try{(await fetch("/api/admin/search-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({company_id:a.id,feature_key:e,is_enabled:t})})).ok?(x(a=>({...a,[e]:t})),W.oR.success(t?"تم تفعيل الصلاحية":"تم إلغاء الصلاحية")):W.oR.error("فشل في تحديث الصلاحية")}catch(e){W.oR.error("حدث خطأ أثناء تحديث الصلاحية")}finally{j(null)}},w=async()=>{if(a)try{(await fetch("/api/admin/search-token",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({company_id:a.id,is_active:+(1!==a.is_active)})})).ok?(i(e=>e?{...e,is_active:+(1!==e.is_active)}:null),W.oR.success(1===a.is_active?"تم تجميد الشركة":"تم تنشيط الشركة")):W.oR.error("فشل في تحديث حالة الشركة")}catch(e){W.oR.error("حدث خطأ")}},z=Object.values(m).filter(Boolean).length,C=(()=>{if(!a)return{text:"",color:"",icon:P.A};if(!a.token_expiry)return{text:"نسخة دائمة",color:"text-indigo-600 bg-indigo-100",icon:D.A};let e=(new Date(a.token_expiry).getTime()-Date.now())/864e5;return e>30?{text:"متبقي ".concat(Math.floor(e)," يوم"),color:"text-emerald-600 bg-emerald-100",icon:q.A}:e>0?{text:"متبقي ".concat(Math.floor(e)," يوم"),color:"text-amber-600 bg-amber-100",icon:B.A}:{text:"انتهى الاشتراك",color:"text-red-600 bg-red-100",icon:J.A}})();return(0,r.jsx)("div",{className:"p-6 md:p-8 bg-slate-50 min-h-screen",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,r.jsx)("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl p-6 text-white shadow-xl",children:(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"w-14 h-14 rounded-xl bg-indigo-500/20 flex items-center justify-center",children:(0,r.jsx)(d.A,{size:28,className:"text-indigo-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-black",children:"البحث عن رمز الاشتراك"}),(0,r.jsx)("p",{className:"text-slate-400 text-sm",children:"البحث عن معلومات الشركة والصلاحيات"})]})]})}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 shadow-sm",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-6 pb-4 border-b border-slate-100",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-xl bg-indigo-100 flex items-center justify-center",children:(0,r.jsx)(c.A,{size:20,className:"text-indigo-600"})}),(0,r.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:"البحث بالرمز"})]}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("div",{className:"flex-1 relative",children:[(0,r.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),onKeyDown:e=>"Enter"===e.key&&N(),placeholder:"أدخل رمز الاشتراك...",className:"w-full px-5 py-4 pr-12 rounded-xl border-2 border-slate-200 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500/20 transition-all text-lg"}),(0,r.jsx)(c.A,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400",size:20})]}),(0,r.jsxs)("button",{onClick:N,disabled:g,className:"flex items-center gap-2 bg-gradient-to-r from-indigo-600 to-blue-600 text-white px-8 py-4 rounded-xl font-bold shadow-lg hover:shadow-indigo-500/30 hover:scale-105 transition-all disabled:opacity-50",children:[g?(0,r.jsx)(M.A,{className:"animate-spin",size:20}):(0,r.jsx)(d.A,{size:20}),"بحث"]})]}),b&&(0,r.jsxs)("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-xl flex items-center gap-3 text-red-700",children:[(0,r.jsx)(P.A,{size:20}),(0,r.jsx)("span",{children:b})]})]}),(0,r.jsx)(n.N,{children:a&&(0,r.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 shadow-sm",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between gap-4 mb-6 pb-4 border-b border-slate-100",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-xl bg-emerald-100 flex items-center justify-center",children:(0,r.jsx)(o.A,{size:20,className:"text-emerald-600"})}),(0,r.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:"معلومات الشركة"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("span",{className:(0,X.cn)("px-3 py-1.5 rounded-full text-xs font-bold flex items-center gap-1",C.color),children:[(0,r.jsx)(C.icon,{size:14}),C.text]}),(0,r.jsxs)("button",{onClick:w,className:(0,X.cn)("flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-bold transition-all",1===a.is_active?"bg-red-100 text-red-700 hover:bg-red-200":"bg-emerald-100 text-emerald-700 hover:bg-emerald-200"),children:[1===a.is_active?(0,r.jsx)(U.A,{size:16}):(0,r.jsx)(H.A,{size:16}),1===a.is_active?"تجميد":"تنشيط"]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,r.jsx)(et,{icon:o.A,label:"اسم المنشأة",value:a.name}),(0,r.jsx)(et,{icon:I.A,label:"السجل التجاري",value:a.commercial_number||"غير متوفر"}),(0,r.jsx)(et,{icon:u.A,label:"الرقم الضريبي",value:a.vat_number||"غير متوفر"}),(0,r.jsx)(et,{icon:K.A,label:"الهاتف",value:a.phone||"غير متوفر"}),(0,r.jsx)(et,{icon:L.A,label:"الدولة",value:a.country||"غير معروفة"}),(0,r.jsx)(et,{icon:L.A,label:"المنطقة",value:a.region||"غير معروفة"}),(0,r.jsx)(et,{icon:_.A,label:"تاريخ الإنشاء",value:a.created_at?new Date(a.created_at).toLocaleDateString("en-US"):"غير معروف"}),(0,r.jsx)(et,{icon:B.A,label:"انتهاء الاشتراك",value:a.token_expiry||"دائم"})]})]}),(0,r.jsx)("div",{className:"bg-gradient-to-r from-indigo-600 to-blue-600 rounded-2xl p-6 text-white shadow-xl",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("p",{className:"text-indigo-200 text-sm mb-2 flex items-center justify-center gap-2",children:[(0,r.jsx)(c.A,{size:16}),"رمز الاشتراك"]}),(0,r.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,r.jsx)("code",{className:"text-2xl font-mono font-bold tracking-widest bg-white/20 px-6 py-3 rounded-xl",children:a.access_token}),(0,r.jsx)("button",{onClick:()=>{(null==a?void 0:a.access_token)&&(navigator.clipboard.writeText(a.access_token),W.oR.success("تم نسخ الرمز!"))},className:"p-3 bg-white/20 rounded-xl hover:bg-white/30 transition-all",children:(0,r.jsx)(Q.A,{size:20})})]})]})}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 shadow-sm",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-6 pb-4 border-b border-slate-100",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-xl bg-rose-100 flex items-center justify-center",children:(0,r.jsx)($.A,{size:20,className:"text-rose-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:"الصلاحيات الإدارية"}),(0,r.jsx)("span",{className:"text-xs text-slate-500",children:"صلاحيات متقدمة"})]})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:f.map(e=>(0,r.jsx)(ea,{feature:e,isEnabled:m[e.key]||!1,isToggling:h===e.key,onToggle:()=>A(e.key),colorClass:"rose"},e.key))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 shadow-sm",children:[(0,r.jsx)("div",{className:"flex items-center justify-between gap-4 mb-6 pb-4 border-b border-slate-100",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-xl bg-emerald-100 flex items-center justify-center",children:(0,r.jsx)(F.A,{size:20,className:"text-emerald-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-bold text-slate-800",children:"الصلاحيات العامة"}),(0,r.jsxs)("span",{className:"text-xs text-slate-500",children:[z," صلاحية مفعلة"]})]})]})}),(0,r.jsx)("div",{className:"space-y-6",children:k.filter(Boolean).map(e=>{let t=v.filter(t=>t.category===e),a=Z[e]||Z["أخرى"];return(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("h3",{className:"text-sm font-bold text-slate-700 flex items-center gap-2",children:[(0,r.jsx)("div",{className:(0,X.cn)("w-1.5 h-5 rounded-full",a.border.replace("border-r-","bg-"))}),e]}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:t.map(t=>(0,r.jsx)(ea,{feature:t,isEnabled:m[t.key]||!1,isToggling:h===t.key,onToggle:()=>A(t.key),colorClass:"emerald",category:e},t.key))})]},e)})})]})]})})]})})}function et(e){let{icon:t,label:a,value:s}=e;return(0,r.jsxs)("div",{className:"bg-slate-50 rounded-xl p-4 border border-slate-100",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-slate-500 text-xs mb-1",children:[(0,r.jsx)(t,{size:14}),a]}),(0,r.jsx)("p",{className:"font-bold text-slate-800",children:s})]})}function ea(e){let{feature:t,isEnabled:a,isToggling:s,onToggle:n,colorClass:o,category:i}=e,c=i?Z[i]||Z["أخرى"]:null;return(0,r.jsx)(l.P.div,{whileTap:{scale:.98},onClick:n,className:(0,X.cn)("cursor-pointer rounded-xl p-4 border-2 transition-all duration-200",c?"border-r-4 ".concat(c.border):"",a?"rose"===o?"bg-rose-50 border-rose-300":"bg-emerald-50 border-emerald-300":"bg-white border-slate-200 hover:border-slate-300"),children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:(0,X.cn)("w-9 h-9 rounded-lg flex items-center justify-center transition-all",a?"rose"===o?"bg-rose-500 text-white":"bg-emerald-500 text-white":"bg-slate-100 text-slate-500"),children:s?(0,r.jsx)(M.A,{className:"animate-spin",size:18}):(0,r.jsx)(t.icon,{size:18})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("h3",{className:"font-bold text-slate-800 text-sm truncate",children:t.name}),(0,r.jsxs)("span",{className:(0,X.cn)("text-xs flex items-center gap-1","admin"===t.type?"text-rose-500":(null==c?void 0:c.icon)||"text-emerald-500"),children:["admin"===t.type?(0,r.jsx)(G.A,{size:10}):(0,r.jsx)(V.A,{size:10}),"admin"===t.type?"إداري":i]})]}),(0,r.jsx)("div",{className:(0,X.cn)("w-10 h-5 rounded-full transition-all duration-200 relative flex-shrink-0",a?"bg-emerald-500":"bg-slate-300"),children:(0,r.jsx)("div",{className:(0,X.cn)("absolute top-0.5 w-4 h-4 rounded-full bg-white shadow transition-all duration-200",a?"right-0.5":"left-0.5")})})]})})}}},e=>{e.O(0,[977,4909,8720,5312,6636,8441,1255,7358],()=>e(e.s=88105)),_N_E=e.O()}]);