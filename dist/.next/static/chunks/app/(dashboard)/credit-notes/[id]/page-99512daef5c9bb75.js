(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1604],{58698:(e,t,s)=>{"use strict";s.d(t,{CreditNoteViewClient:()=>y});var a=s(95155),r=s(12115),l=s(52987),n=s(309),i=s(39867),c=s(19408),d=s(46398),o=s(89715),x=s(16485),m=s(80647),f=s(52056),p=s(78519),b=s(54690),h=s(52619),j=s.n(h),g=s(12834),u=s(86550),N=s(48003),v=s(64269),w=s(94222);function y(e){var t;let{creditNote:h,qrData:y}=e,k=(0,r.useRef)(null),[_,z]=(0,r.useState)(!1),[S,C]=(0,r.useState)(!1);(0,r.useEffect)(()=>{C(!0)},[]);let A=(0,w.useReactToPrint)({contentRef:k,documentTitle:"إشعار دائن - ".concat(h.credit_note_number)}),F=async()=>{z(!0);try{let e=(await s.e(4316).then(s.t.bind(s,54264,23))).default,{jsPDF:t}=await Promise.all([s.e(5033),s.e(3930),s.e(6241)]).then(s.bind(s,55172)),a=k.current;if(!a)return;let r=await e(a,{scale:3,useCORS:!0,logging:!1,backgroundColor:"#ffffff",windowWidth:a.scrollWidth,windowHeight:a.scrollHeight}),l=r.toDataURL("image/png"),n=new t("p","mm","a4"),i=n.internal.pageSize.getWidth(),c=n.internal.pageSize.getHeight(),d=r.height*i/r.width,o=d,x=i;if(d>c){let e=c/d;o=c,x=i*e}let m=(i-x)/2;n.addImage(l,"PNG",m,0,x,o),n.save("إشعار-دائن-".concat(h.credit_note_number,".pdf"))}catch(e){console.error("Error generating PDF:",e)}finally{z(!1)}},D=e=>{if(!e)return"-";try{return(0,u.GP)(new Date(e),"dd-MM-yyyy",{locale:N.ar})}catch(t){return e}};return(0,a.jsx)("div",{className:"min-h-screen bg-transparent overflow-y-auto font-tajawal",children:(0,a.jsxs)("div",{className:"w-full max-w-[210mm] mx-auto py-6 space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 justify-center no-print px-4",children:[(0,a.jsx)(j(),{href:"/credit-notes",children:(0,a.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-white text-[#334155] hover:bg-[#f8fafc] border border-[#e2e8f0] font-bold text-sm transition-all shadow-sm",children:[(0,a.jsx)(l.A,{size:18}),"العودة"]})}),(0,a.jsxs)("button",{onClick:()=>A(),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-[#1e293b] text-white hover:bg-[#0f172a] font-bold text-sm transition-all shadow-md",children:[(0,a.jsx)(n.A,{size:18}),"طباعة"]}),(0,a.jsxs)("button",{onClick:F,disabled:_,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-[#2563eb] text-white hover:bg-[#1d4ed8] font-bold text-sm transition-all shadow-md disabled:opacity-50",children:[(0,a.jsx)(i.A,{size:18}),_?"جاري...":"تحميل PDF"]})]}),(0,a.jsxs)("div",{ref:k,className:"invoice-container bg-white shadow-xl overflow-hidden border border-[#f1f5f9] mx-auto",style:{width:"210mm",minHeight:"297mm",backgroundColor:"#ffffff",color:"#0f172a",display:"flex",flexDirection:"column",boxSizing:"border-box"},children:[(0,a.jsx)("style",{children:"\n            @media print {\n              .no-print { display: none !important; }\n              body { \n                background: white !important; \n                margin: 0 !important; \n                padding: 0 !important;\n              }\n              .invoice-container { \n                box-shadow: none !important; \n                margin: 0 !important; \n                width: 210mm !important; \n                min-height: 297mm !important;\n                max-width: 100% !important; \n                border: none !important;\n                padding: 0 !important;\n                overflow: visible !important;\n                display: flex !important;\n                flex-direction: column !important;\n                background: white !important;\n                -webkit-print-color-adjust: exact !important;\n                print-color-adjust: exact !important;\n              }\n              @page {\n                size: A4 portrait;\n                margin: 0;\n              }\n              * {\n                -webkit-print-color-adjust: exact !important;\n                print-color-adjust: exact !important;\n              }\n            }\n          "}),(0,a.jsxs)("div",{className:"text-white p-6 relative overflow-hidden",style:{background:"linear-gradient(135deg, #1e293b 0%, #2c3e50 100%)"},children:[(0,a.jsxs)("div",{className:"flex flex-row justify-between items-center gap-4 relative z-10",children:[(0,a.jsx)("div",{className:"w-20 h-20 rounded-xl flex items-center justify-center p-3 border border-[#ffffff33]",style:{backgroundColor:"rgba(255,255,255,0.1)"},children:h.company_logo?(0,a.jsx)("img",{src:((t=h.company_logo)?t.startsWith("http")?t:"".concat("https://xaexoopjqkrzhbochbef.supabase.co","/storage/v1/object/public/project-uploads/").concat(t):null)||"",alt:"Logo",className:"max-w-full max-h-full object-contain rounded-md",crossOrigin:"anonymous"}):(0,a.jsx)(c.A,{size:36,className:"text-white/60"})}),(0,a.jsxs)("div",{className:"text-center flex-1",children:[(0,a.jsx)("h1",{className:"text-2xl font-black mb-0 tracking-wider",children:"إشعار دائن ضريبي"}),(0,a.jsx)("p",{className:"text-white/60 text-[12px] uppercase font-light",children:"Credit Note"}),(0,a.jsx)("div",{className:"mt-2 inline-flex items-center gap-2 px-4 py-1 rounded-lg border border-[#ffffff1a]",style:{backgroundColor:"rgba(255,255,255,0.05)"},children:(0,a.jsx)("span",{className:"font-bold text-[10px]",children:"نظام الفواتير الإلكترونية"})})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center gap-1 p-3 rounded-xl border border-[#ffffff1a] min-w-[120px]",style:{backgroundColor:"rgba(255,255,255,0.05)"},children:[(0,a.jsx)(d.A,{size:24,className:"text-[#3b82f6]"}),(0,a.jsx)("h2",{className:"text-[10px] font-black text-white uppercase",children:"Logistics Systems"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 mt-6 pt-4 border-t border-[#ffffff1a] relative z-10",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("span",{className:"text-[#ffffff66] text-[10px] block",children:"رقم الإشعار:"}),(0,a.jsx)("p",{className:"font-bold text-[13px] tracking-widest",children:h.credit_note_number})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("span",{className:"text-[#ffffff66] text-[10px] block",children:"تاريخ الإصدار:"}),(0,a.jsx)("p",{className:"font-bold text-[13px]",children:D(h.created_at)})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("span",{className:"text-[#ffffff66] text-[10px] block",children:"الحالة:"}),(0,a.jsx)("p",{className:(0,v.cn)("font-bold text-[13px]","cancelled"===h.status?"text-red-400":"text-green-400"),children:"cancelled"===h.status?"ملغي":"نشط"})]})]})]}),(0,a.jsxs)("div",{className:"p-8 space-y-8 flex-grow flex flex-col",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-8",children:[(0,a.jsxs)("div",{className:"rounded-[2rem] p-6 border-2 border-[#f1f5f9] relative overflow-hidden group hover:border-[#2563eb]/20 transition-all shadow-sm",style:{backgroundColor:"#f8fafc"},children:[(0,a.jsx)("div",{className:"absolute top-0 right-0 w-24 h-24 bg-[#2563eb]/5 rounded-bl-[4rem] -z-0"}),(0,a.jsxs)("h3",{className:"font-black text-[#0f172a] mb-5 pb-3 border-b-2 border-[#e2e8f0] flex items-center gap-3 text-sm relative z-10",children:[(0,a.jsx)("div",{className:"w-2 h-5 bg-[#2563eb] rounded-full"}),"بيانات البائع ",(0,a.jsx)("span",{className:"text-[10px] text-slate-400 font-bold opacity-50",children:"Seller Details"})]}),(0,a.jsxs)("div",{className:"space-y-3 text-[12px] relative z-10",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start gap-4",children:[(0,a.jsx)("span",{className:"text-[#64748b] font-bold",children:"اسم الشركة:"}),(0,a.jsx)("span",{className:"font-black text-[#0f172a] text-right",children:h.company_name})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-y border-dashed border-slate-200",children:[(0,a.jsx)("span",{className:"text-[#64748b] font-bold",children:"السجل التجاري:"}),(0,a.jsx)("span",{className:"font-black text-[#0f172a] tracking-wider",children:h.company_cr||"-"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-[#64748b] font-bold",children:"الرقم الضريبي:"}),(0,a.jsx)("span",{className:"font-black text-[#2563eb] text-sm",children:h.company_vat})]}),(0,a.jsxs)("div",{className:"flex justify-start gap-3 mt-2 pt-2 border-t border-slate-100",children:[(0,a.jsx)("span",{className:"text-[#64748b] font-bold whitespace-nowrap",children:"العنوان:"}),(0,a.jsx)("span",{className:"font-bold text-[#0f172a] leading-relaxed text-right text-[11px]",children:h.company_address})]})]})]}),(0,a.jsxs)("div",{className:"rounded-[2rem] p-6 border-2 border-[#f1f5f9] relative overflow-hidden group hover:border-[#059669]/20 transition-all shadow-sm",style:{backgroundColor:"#f8fafc"},children:[(0,a.jsx)("div",{className:"absolute top-0 right-0 w-24 h-24 bg-[#059669]/5 rounded-bl-[4rem] -z-0"}),(0,a.jsxs)("h3",{className:"font-black text-[#0f172a] mb-5 pb-3 border-b-2 border-[#e2e8f0] flex items-center gap-3 text-sm relative z-10",children:[(0,a.jsx)("div",{className:"w-2 h-5 bg-[#059669] rounded-full"}),"بيانات العميل ",(0,a.jsx)("span",{className:"text-[10px] text-slate-400 font-bold opacity-50",children:"Customer Details"})]}),(0,a.jsxs)("div",{className:"space-y-3 text-[12px] relative z-10",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start gap-4",children:[(0,a.jsx)("span",{className:"text-[#64748b] font-bold",children:"اسم العميل:"}),(0,a.jsx)("span",{className:"font-black text-[#0f172a] text-right",children:h.client_name})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-y border-dashed border-slate-200",children:[(0,a.jsx)("span",{className:"text-[#64748b] font-bold",children:"السجل التجاري:"}),(0,a.jsx)("span",{className:"font-black text-[#0f172a] tracking-wider",children:h.client_cr||"-"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-[#64748b] font-bold",children:"الرقم الضريبي:"}),(0,a.jsx)("span",{className:"font-black text-[#059669] text-sm",children:h.client_vat||"-"})]}),(0,a.jsxs)("div",{className:"flex justify-start gap-3 mt-2 pt-2 border-t border-slate-100",children:[(0,a.jsx)("span",{className:"text-[#64748b] font-bold whitespace-nowrap",children:"العنوان:"}),(0,a.jsx)("span",{className:"font-bold text-[#0f172a] leading-relaxed text-right text-[11px]",children:h.client_address||"-"})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-[#1e293b] p-6 rounded-[2rem] border-2 border-slate-200 flex flex-wrap gap-8 items-center justify-between relative overflow-hidden shadow-lg shadow-slate-200/50",children:[(0,a.jsx)("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-r from-blue-500/10 to-transparent opacity-50"}),(0,a.jsxs)("div",{className:"flex items-center gap-4 relative z-10",children:[(0,a.jsx)("div",{className:"p-3 bg-white/10 backdrop-blur-md rounded-2xl border border-white/20 shadow-inner",children:(0,a.jsx)(o.A,{size:24,className:"text-blue-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1",children:"مرجع الفاتورة الأصلية"}),(0,a.jsx)("p",{className:"text-xl font-black text-white",children:h.invoice_number})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 relative z-10",children:[(0,a.jsx)("div",{className:"p-3 bg-white/10 backdrop-blur-md rounded-2xl border border-white/20 shadow-inner",children:(0,a.jsx)(x.A,{size:24,className:"text-orange-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1",children:"تاريخ الفاتورة"}),(0,a.jsx)("p",{className:"text-lg font-black text-white",children:D(h.invoice_date)})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 relative z-10",children:[(0,a.jsx)("div",{className:"p-3 bg-white/10 backdrop-blur-md rounded-2xl border border-white/20 shadow-inner",children:(0,a.jsx)(m.A,{size:24,className:"text-green-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1",children:"إجمالي الفاتورة"}),(0,a.jsxs)("p",{className:"text-lg font-black text-white",children:[parseFloat(h.invoice_total_amount).toLocaleString()," ",(0,a.jsx)("span",{className:"text-xs font-normal opacity-50",children:"ريال"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h3",{className:"text-sm font-black text-slate-400 uppercase tracking-widest flex items-center gap-2",children:[(0,a.jsx)(f.A,{size:14,className:"text-amber-500"}),"سبب إصدار الإشعار"]}),(0,a.jsx)("div",{className:"bg-white p-5 rounded-2xl border border-slate-200 min-h-[80px] italic text-slate-600 font-medium text-[13px]",children:h.reason})]}),(0,a.jsx)("div",{className:"rounded-xl border border-[#f1f5f9] overflow-hidden shadow-sm",children:(0,a.jsxs)("table",{className:"w-full text-[11px] border-collapse",children:[(0,a.jsx)("thead",{style:{background:"#1e293b",color:"#ffffff"},children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-3 py-3 text-right font-bold",children:"الوصف"}),(0,a.jsx)("th",{className:"px-3 py-3 text-center font-bold",children:"قبل الضريبة"}),(0,a.jsx)("th",{className:"px-3 py-3 text-center font-bold",children:"الضريبة 15%"}),(0,a.jsx)("th",{className:"px-3 py-3 text-center font-bold",children:"الإجمالي المسترجع"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-[#f1f5f9] bg-white",children:(0,a.jsxs)("tr",{children:[(0,a.jsxs)("td",{className:"px-3 py-4 font-bold text-[#0f172a]",children:["مبلغ إشعار الدائن المسترجع",(0,a.jsxs)("p",{className:"text-[9px] text-slate-400 font-medium mt-0.5",children:["خصم من الفاتورة رقم ",h.invoice_number]})]}),(0,a.jsxs)("td",{className:"px-3 py-4 text-center font-medium",children:[parseFloat(h.total_before_vat).toLocaleString("en-US",{minimumFractionDigits:2})," ريال"]}),(0,a.jsxs)("td",{className:"px-3 py-4 text-center text-[#2563eb] font-bold",children:[parseFloat(h.vat_amount).toLocaleString("en-US",{minimumFractionDigits:2})," ريال"]}),(0,a.jsxs)("td",{className:"px-3 py-4 text-center font-black text-red-600 text-[14px]",children:[parseFloat(h.total_amount).toLocaleString("en-US",{minimumFractionDigits:2})," ريال"]})]})})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6 items-stretch mt-auto",children:[(0,a.jsxs)("div",{className:"rounded-2xl p-5 border border-[#f1f5f9] flex flex-col justify-between",style:{background:"#f8fafc"},children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-black text-[#0f172a] mb-3 flex items-center gap-2 text-[13px]",children:[(0,a.jsx)(p.A,{size:16,className:"text-[#2563eb]"}),"ملخص الإشعار"]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center py-1.5 border-b border-dashed border-[#e2e8f0]",children:[(0,a.jsx)("span",{className:"text-[#64748b] text-[11px]",children:"قبل الضريبة:"}),(0,a.jsxs)("span",{className:"font-bold text-[#0f172a] text-[11px]",children:[parseFloat(h.total_before_vat).toLocaleString("en-US",{minimumFractionDigits:2})," ريال"]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center py-1.5 border-b border-dashed border-[#e2e8f0]",children:[(0,a.jsx)("span",{className:"text-[#64748b] text-[11px]",children:"الضريبة 15%:"}),(0,a.jsxs)("span",{className:"font-bold text-[#2563eb] text-[11px]",children:[parseFloat(h.vat_amount).toLocaleString("en-US",{minimumFractionDigits:2})," ريال"]})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center py-3 px-4 rounded-xl mt-4 shadow-md",style:{background:"#dc2626"},children:[(0,a.jsx)("span",{className:"font-black text-white text-[12px]",children:"الإجمالي المسترجع:"}),(0,a.jsxs)("span",{className:"font-black text-[14px] text-white",children:[parseFloat(h.total_amount).toLocaleString("en-US",{minimumFractionDigits:2})," ريال"]})]})]}),(0,a.jsxs)("div",{className:"rounded-2xl p-5 border border-[#f1f5f9] bg-white text-center flex flex-col justify-between shadow-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-black text-[#0f172a] mb-3 flex items-center justify-center gap-2 text-[13px]",children:[(0,a.jsx)(b.A,{size:16,className:"text-[#2563eb]"}),"باركود ZATCA"]}),(0,a.jsx)("div",{className:"flex justify-center mb-2",children:(0,a.jsx)("div",{className:"p-2 bg-white rounded-xl shadow-sm border border-[#f8fafc]",children:S&&(0,a.jsx)(g.X,{value:y,size:130,level:"H",includeMargin:!1})})})]}),(0,a.jsx)("div",{className:"pt-2 border-t border-[#f1f5f9]",children:(0,a.jsx)("p",{className:"text-[9px] font-bold text-slate-400",children:"مستند ضريبي معتمد - المرحلة الأولى"})})]})]}),(0,a.jsx)("div",{className:"pt-6 border-t border-[#f1f5f9]",children:(0,a.jsx)("p",{className:"text-[10px] text-center text-slate-400 font-medium",children:"هذا المستند تم إنشاؤه آلياً وهو متوافق مع متطلبات هيئة الزكاة والضريبة والجمارك (ZATCA)."})})]})]})]})})}},64269:(e,t,s)=>{"use strict";s.d(t,{cn:()=>l});var a=s(2821),r=s(75889);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.QP)((0,a.$)(t))}},91308:(e,t,s)=>{Promise.resolve().then(s.bind(s,58698))}},e=>{e.O(0,[4909,2619,6550,6986,618,8441,1255,7358],()=>e(e.s=91308)),_N_E=e.O()}]);