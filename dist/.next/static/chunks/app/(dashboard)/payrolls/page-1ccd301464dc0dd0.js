(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7737],{8494:(e,t,s)=>{"use strict";s.d(t,{PayrollsListClient:()=>w});var l=s(95155),a=s(12115),r=s(26497),i=s(8751),d=s(42529),n=s(6132),x=s(35299),c=s(89715),o=s(86651),m=s(6191),h=s(16485),b=s(91169),p=s(91761),u=s(26983),g=s(57828),j=s(11010),f=s(71360),y=s(52619),N=s.n(y),v=s(20063);function w(e){let{payrolls:t,stats:s,companyId:y}=e,[w,k]=(0,a.useState)(t),[z,_]=(0,a.useState)(""),[A,C]=(0,a.useState)(null),[L,S]=(0,a.useState)({show:!1,type:"success",title:"",message:""}),E=(0,v.useRouter)(),P=w.filter(e=>{var t,s,l;let a=z.toLowerCase();return(null==(t=e.payroll_month)?void 0:t.toLowerCase().includes(a))||(null==(s=e.package_name)?void 0:s.toLowerCase().includes(a))||(null==(l=e.saved_by)?void 0:l.toLowerCase().includes(a))}),D=(e,t,s)=>{S({show:!0,type:e,title:t,message:s}),"loading"!==e&&setTimeout(()=>S(e=>({...e,show:!1})),3e3)},F=async(e,t)=>{if(confirm('هل أنت متأكد من حذف مسير "'.concat(t,'"؟'))){C(e),D("loading","جاري الحذف","جاري حذف المسير...");try{(await fetch("/api/payrolls/".concat(e),{method:"DELETE"})).ok?(k(t=>t.filter(t=>t.id!==e)),D("success","تم الحذف بنجاح","تم حذف المسير بنجاح"),E.refresh()):D("error","فشل الحذف","فشل حذف المسير")}catch(e){D("error","خطأ","حدث خطأ أثناء الحذف")}finally{C(null)}}};return(0,l.jsxs)("div",{className:"h-full flex flex-col",children:[(0,l.jsx)(r.N,{children:L.show&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50",onClick:()=>"loading"!==L.type&&S(e=>({...e,show:!1}))}),(0,l.jsx)(i.P.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-50 w-full max-w-md",children:(0,l.jsx)("div",{className:"bg-white rounded-3xl p-8 shadow-2xl border-t-4 ".concat("success"===L.type?"border-emerald-500":"error"===L.type?"border-red-500":"border-blue-500"),children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsxs)("div",{className:"h-20 w-20 rounded-full mx-auto mb-6 flex items-center justify-center ".concat("success"===L.type?"bg-emerald-100 text-emerald-500":"error"===L.type?"bg-red-100 text-red-500":"bg-blue-100 text-blue-500"),children:["success"===L.type&&(0,l.jsx)(d.A,{size:40}),"error"===L.type&&(0,l.jsx)(n.A,{size:40}),"loading"===L.type&&(0,l.jsx)(x.A,{size:40,className:"animate-spin"})]}),(0,l.jsx)("h3",{className:"text-2xl font-black text-gray-900 mb-2",children:L.title}),(0,l.jsx)("p",{className:"text-gray-500 mb-6",children:L.message}),"loading"!==L.type&&(0,l.jsx)("button",{onClick:()=>S(e=>({...e,show:!1})),className:"px-8 py-3 rounded-xl font-bold text-white transition-all ".concat("success"===L.type?"bg-emerald-500 hover:bg-emerald-600":"bg-red-500 hover:bg-red-600"),children:"حسناً"})]})})})]})}),(0,l.jsx)("div",{className:"flex-1 overflow-auto p-6",children:(0,l.jsxs)("div",{className:"max-w-[1600px] mx-auto space-y-6",children:[(0,l.jsxs)("div",{className:"relative overflow-hidden bg-gradient-to-br from-[#1a237e] to-[#283593] rounded-2xl p-6 text-white shadow-xl",children:[(0,l.jsx)("div",{className:"relative z-10",children:(0,l.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("div",{className:"h-14 w-14 rounded-xl bg-amber-500 flex items-center justify-center shadow-lg",children:(0,l.jsx)(c.A,{size:28})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-black",children:"مسيرات الرواتب"}),(0,l.jsx)("p",{className:"text-white/60 text-sm",children:"إدارة مسيرات رواتب الموظفين"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-4 gap-3",children:[(0,l.jsxs)("div",{className:"bg-white/10 backdrop-blur rounded-xl p-3 text-center",children:[(0,l.jsx)("div",{className:"text-2xl font-black",children:s.total}),(0,l.jsx)("div",{className:"text-[10px] text-white/60 font-bold",children:"إجمالي"})]}),(0,l.jsxs)("div",{className:"bg-emerald-500/20 backdrop-blur rounded-xl p-3 text-center",children:[(0,l.jsx)("div",{className:"text-lg font-black text-emerald-300",children:Number(s.total_amount).toLocaleString("en-US")}),(0,l.jsx)("div",{className:"text-[10px] text-white/60 font-bold",children:"ر.س"})]}),(0,l.jsxs)("div",{className:"bg-green-500/20 backdrop-blur rounded-xl p-3 text-center",children:[(0,l.jsx)("div",{className:"text-2xl font-black text-green-300",children:s.confirmed_count}),(0,l.jsx)("div",{className:"text-[10px] text-white/60 font-bold",children:"مؤكد"})]}),(0,l.jsxs)("div",{className:"bg-amber-500/20 backdrop-blur rounded-xl p-3 text-center",children:[(0,l.jsx)("div",{className:"text-2xl font-black text-amber-300",children:s.draft_count}),(0,l.jsx)("div",{className:"text-[10px] text-white/60 font-bold",children:"مسودة"})]})]})]})}),(0,l.jsx)("div",{className:"absolute top-0 right-0 w-40 h-40 bg-white/5 rounded-full -mr-20 -mt-20 blur-2xl"})]}),(0,l.jsx)("div",{className:"bg-white rounded-2xl border border-gray-100 p-4 shadow-sm",children:(0,l.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[(0,l.jsxs)("div",{className:"relative w-full md:w-80",children:[(0,l.jsx)(o.A,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),(0,l.jsx)("input",{type:"text",placeholder:"بحث بشهر المسير أو الباقة...",value:z,onChange:e=>_(e.target.value),className:"w-full pr-10 pl-4 py-2.5 rounded-xl border border-gray-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 outline-none text-sm"})]}),(0,l.jsx)("div",{className:"flex gap-2 flex-wrap",children:(0,l.jsx)(N(),{href:"/payrolls/new",children:(0,l.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2.5 rounded-xl bg-emerald-500 text-white font-bold text-sm hover:bg-emerald-600 transition-all",children:[(0,l.jsx)(m.A,{size:16}),(0,l.jsx)("span",{children:"إنشاء مسير جديد"})]})})})]})}),(0,l.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden",children:[(0,l.jsxs)("div",{className:"bg-gradient-to-br from-[#1a237e] to-[#283593] px-4 py-3 flex justify-between items-center",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-white",children:[(0,l.jsx)(c.A,{size:18}),(0,l.jsx)("h3",{className:"font-bold text-sm",children:"قائمة مسيرات الرواتب"})]}),(0,l.jsxs)("span",{className:"bg-white/20 text-white px-2 py-0.5 rounded text-xs font-bold",children:[P.length," مسير"]})]}),P.length>0?(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full",children:[(0,l.jsx)("thead",{className:"bg-gray-50",children:(0,l.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,l.jsx)("th",{className:"text-right px-4 py-3 text-xs font-bold text-gray-600",children:"#"}),(0,l.jsx)("th",{className:"text-right px-4 py-3 text-xs font-bold text-gray-600",children:"شهر المسير"}),(0,l.jsx)("th",{className:"text-right px-4 py-3 text-xs font-bold text-gray-600",children:"الباقة"}),(0,l.jsx)("th",{className:"text-right px-4 py-3 text-xs font-bold text-gray-600",children:"عدد الموظفين"}),(0,l.jsx)("th",{className:"text-right px-4 py-3 text-xs font-bold text-gray-600",children:"إجمالي الرواتب"}),(0,l.jsx)("th",{className:"text-right px-4 py-3 text-xs font-bold text-gray-600",children:"الحالة"}),(0,l.jsx)("th",{className:"text-center px-4 py-3 text-xs font-bold text-gray-600",children:"الإجراءات"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-gray-50",children:P.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-gray-50/50 transition-colors",children:[(0,l.jsx)("td",{className:"px-4 py-3 text-sm text-gray-500",children:e.id}),(0,l.jsx)("td",{className:"px-4 py-3",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"h-8 w-8 rounded-lg bg-blue-50 flex items-center justify-center text-blue-500",children:(0,l.jsx)(h.A,{size:14})}),(0,l.jsx)("span",{className:"font-bold text-gray-900 text-sm",children:e.payroll_month})]})}),(0,l.jsx)("td",{className:"px-4 py-3",children:(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,l.jsx)("span",{className:"font-bold text-gray-900 text-sm",children:e.package_name||"غير محدد"}),(0,l.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full inline-block w-fit ".concat((e=>{switch(e){case"salary":return"bg-emerald-100 text-emerald-700";case"target":return"bg-blue-100 text-blue-700";case"tiers":return"bg-purple-100 text-purple-700";case"commission":return"bg-amber-100 text-amber-700";default:return"bg-gray-100 text-gray-700"}})(e.work_type)),children:(e=>{switch(e){case"salary":return"الراتب الثابت";case"target":return"نظام التارقت";case"tiers":return"نظام الشرائح";case"commission":return"نظام العمولة";default:return e}})(e.work_type)})]})}),(0,l.jsx)("td",{className:"px-4 py-3",children:(0,l.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,l.jsx)(b.A,{size:14,className:"text-gray-400"}),(0,l.jsx)("span",{className:"font-bold",children:e.employee_count}),(0,l.jsx)("span",{className:"text-gray-400 text-xs",children:"موظف"})]})}),(0,l.jsx)("td",{className:"px-4 py-3",children:(0,l.jsxs)("div",{className:"flex items-center gap-1 text-sm font-bold text-emerald-600",children:[(0,l.jsx)(p.A,{size:14}),Number(e.total_amount||0).toLocaleString("en-US",{minimumFractionDigits:2}),(0,l.jsx)("span",{className:"text-xs text-gray-400",children:"ر.س"})]})}),(0,l.jsx)("td",{className:"px-4 py-3",children:e.is_draft?(0,l.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-amber-100 text-amber-700 text-xs font-bold",children:[(0,l.jsx)(u.A,{size:10}),"مسودة"]}):(0,l.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-emerald-100 text-emerald-700 text-xs font-bold",children:[(0,l.jsx)(d.A,{size:10}),"تم التأكيد"]})}),(0,l.jsx)("td",{className:"px-4 py-3",children:(0,l.jsxs)("div",{className:"flex items-center justify-center gap-1 flex-wrap",children:[(0,l.jsx)(N(),{href:"/payrolls/".concat(e.id),children:(0,l.jsx)("button",{className:"h-7 w-7 rounded-lg bg-blue-50 text-blue-500 flex items-center justify-center hover:bg-blue-500 hover:text-white transition-all",title:"عرض",children:(0,l.jsx)(g.A,{size:14})})}),(0,l.jsx)(N(),{href:"/payrolls/".concat(e.id,"/edit"),children:(0,l.jsx)("button",{className:"h-7 w-7 rounded-lg bg-amber-50 text-amber-500 flex items-center justify-center hover:bg-amber-500 hover:text-white transition-all",title:"تعديل",children:(0,l.jsx)(j.A,{size:14})})}),(0,l.jsx)("button",{onClick:()=>F(e.id,e.payroll_month),disabled:A===e.id,className:"h-7 w-7 rounded-lg bg-red-50 text-red-500 flex items-center justify-center hover:bg-red-500 hover:text-white transition-all disabled:opacity-50",title:"حذف",children:A===e.id?(0,l.jsx)("div",{className:"h-3 w-3 border-2 border-current border-t-transparent rounded-full animate-spin"}):(0,l.jsx)(f.A,{size:14})})]})})]},e.id))})]})}):(0,l.jsxs)("div",{className:"py-16 text-center",children:[(0,l.jsx)(c.A,{size:48,className:"mx-auto text-gray-200 mb-4"}),(0,l.jsx)("h4",{className:"text-lg font-bold text-gray-600 mb-2",children:"لا توجد مسيرات رواتب"}),(0,l.jsx)("p",{className:"text-gray-400 text-sm mb-4",children:"ابدأ بإنشاء مسير رواتب جديد"}),(0,l.jsx)(N(),{href:"/payrolls/new",children:(0,l.jsxs)("button",{className:"inline-flex items-center gap-2 px-5 py-2.5 rounded-xl bg-emerald-500 text-white font-bold text-sm hover:bg-emerald-600 transition-all",children:[(0,l.jsx)(m.A,{size:16}),(0,l.jsx)("span",{children:"إنشاء مسير جديد"})]})})]})]})]})})]})}},28926:(e,t,s)=>{Promise.resolve().then(s.bind(s,8494))}},e=>{e.O(0,[977,2619,946,8441,1255,7358],()=>e(e.s=28926)),_N_E=e.O()}]);